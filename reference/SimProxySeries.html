<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function creates a time series that is designed such that
  it can be interpreted as a typical paleo proxy record. It corresponds to
  what one may expect when an underlying signal, exhibiting power-law
  frequency scaling over a finite range of frequencies (from f_low to
  f_high), is subject to archive and laboratory smoothing and then subsampled
  at potentially unequally spaced sampling times, with a single noisy
  measurement made on a finite number of signal carriers retrieved from the
  same physical sample."><title>Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the
Climate — SimProxySeries • PaleoSpec</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the
Climate — SimProxySeries"><meta property="og:description" content="This function creates a time series that is designed such that
  it can be interpreted as a typical paleo proxy record. It corresponds to
  what one may expect when an underlying signal, exhibiting power-law
  frequency scaling over a finite range of frequencies (from f_low to
  f_high), is subject to archive and laboratory smoothing and then subsampled
  at potentially unequally spaced sampling times, with a single noisy
  measurement made on a finite number of signal carriers retrieved from the
  same physical sample."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PaleoSpec</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the
Climate</h1>
      
      <div class="d-none name"><code>SimProxySeries.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a time series that is designed such that
  it can be interpreted as a typical paleo proxy record. It corresponds to
  what one may expect when an underlying signal, exhibiting power-law
  frequency scaling over a finite range of frequencies (from f_low to
  f_high), is subject to archive and laboratory smoothing and then subsampled
  at potentially unequally spaced sampling times, with a single noisy
  measurement made on a finite number of signal carriers retrieved from the
  same physical sample.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SimProxySeries</span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nt <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  f.scl <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  smth.arch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"n"</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  smth.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"n"</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  t.smpl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var.noise <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  val <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  rseeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  nser <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sim.proxy.series</span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nt <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  f.scl <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  smth.arch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"n"</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  smth.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"n"</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  t.smpl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var.noise <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  val <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  rseeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  nser <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>a</dt>
<dd><p>If a &gt;= 0: proportionality constant of the underlying expected power
  spectral density P = a * f^-b.</p>
<p>If a &lt; 0: expected mean square (variance) of the final time series (the
  value of the function). Thus, the underlying power spectral density is
  given by P ~ f^-b.</p></dd>


<dt>b</dt>
<dd><p>Scaling exponent of the underlying power spectral density P = a *
f^-b.</p></dd>


<dt>nt</dt>
<dd><p>Determines the lower cut-off frequency: f_low = f.scl / nt.</p>
<p>If t.smpl == NULL: number of sampling times (length of the final time
  series).</p></dd>


<dt>f.scl</dt>
<dd><p>If t.smpl != NULL: Scales the cut-off frequencies (lower and
  upper): f_low = f.scl / nt, and f_high = f.scl * 0.5.</p>
<p>If t.smpl == NULL: f.scl has no effect.</p></dd>


<dt>smth.arch</dt>
<dd><p>Sets type and time scale of archive smoothing. Possible
  values of type are "n": no archive smoothing; "bioturbation": 'Berger and
  Heath' impulse response function, with a Lorentzian-shaped squared spectral
  transfer function 1 / (1 + (2*pi*f*tau)^2); "diffusion": Gaussian-shaped
  squared spectral transfer function exp(-(2*pi*f*tau)^2).</p>
<p>Possible values of tau are positive real numbers. Setting tau == 0 is
  equivalent to setting type="n".</p></dd>


<dt>smth.lab</dt>
<dd><p>Sets type and time scale of laboratory smoothing. Possible
  values of type are "n": no archive smoothing "rect": a rectangular window
  in the time domain (archive slice) -&gt; Squared-sinc-shaped squared spectral
  transfer function sinc^2(pi*f*tau)</p>
<p>Possible values of tau are positive real numbers. Setting tau == 0 is
  equivalent to setting type="n".</p></dd>


<dt>N</dt>
<dd><p>N &gt; 0: Finite number of signal carriers used for a single
measurement, implying an additional sample white noise scaled by 1/N. N ==
0: Infinite number of signal carriers, implying no additional sample white
noise.</p></dd>


<dt>t.smpl</dt>
<dd><p>The desired (arbitrary) sampling times (may contain duplicated
entries and does not need to be ordered in time). If t.smpl == NULL:
sampling times are 0:(nt-1), using the FFT algorithm for fast computation.
If t.smpl != NULL: specifies the desired arbitrary (and potentially
unequally spaced) sampling times. When set to 0:(nt-1), the result is
identical to that obtained with t.smpl == NULL, but computation is
(potentially much) slower because FFT algorithm is not used.</p></dd>


<dt>var.noise</dt>
<dd><p>Variance of additional sample white noise (which may
represent, for example, measurement noise).</p></dd>


<dt>val</dt>
<dd><p>If val == 0: the value of the function is the time series.</p>
<p>If val &gt; 0: the value of the function is a list that holds information
  regarding the true PSD. It has the components</p>
<p>$fax: the frequency axis $psd: the power spectral density $var: the
  variance of the total sample white noise (component exists only if the
  sample white noise is not included in the component $psd, see below)</p>
<p>Possible positive values of val are</p>
<p>1: $psd holds the full PSD, including the sample white noise; vectors $psd
  and $fax are limited to those elements where $fax &gt; 0</p>
<p>2: $psd holds the PSD excluding the sample white noise, the variance of
  which is provided in the component $var; vectors $psd and $fax are limited
  to those elements where $fax &gt; 0</p>
<p>3: same as '1', but the vectors $psd and $fax extend over all frequencies
  (including zero and the negative ones)</p>
<p>4: same as '2', but the vectors $psd and $fax extend over all frequencies
  (including zero and the negative ones)</p>
<p>Note: If t.smpl != NULL and val == 1 or val == 3, then the function
  internally sets val &lt;- val + 1, because t.smpl might specify unequally
  spaced sampling times such that the PSD of the sample white noise might not
  be defined.</p></dd>


<dt>rseeds</dt>
<dd><p>vector of length 3, integer or NA. Random seeds to fix the
realisation of specific random processes. There are three random processes:</p>
<p>process-1 (controlled by rseeds[1]) represents the climate
  process-2 (controlled by rseeds[2]) represents the signal carrier mixing
  paths
  process-3 (controlled by rseeds[3]) represents the additional sample white
  noise (e.g., measurement noise)</p>
<p>If rseeds[i] == NA: a random sequence is drawn with rnorm() without setting
  a specific random seed before.</p>
<p>If rseeds[i] == integer: a random seed is set with set.seed(rseeds[i]) and
  then a random sequence is drawn with rnorm. After this draw the random
  number generator is reset to its previous state in order to avoid any
  interference with other calls to the random number generator inside or
  outside of sim.proxy.series.</p></dd>


<dt>nser</dt>
<dd><p>integer (&gt;=1) If val == 0: number of time series generated (all
with the same parameters). If val &gt; 0: nser has no effect.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A vector or list.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions to generate timeseries with powerlaw like spectra: 
<code><a href="SimFromEmpiricalSpec.html">SimFromEmpiricalSpec</a>()</code>,
<code><a href="SimPLS.html">SimPLS</a>()</code>,
<code><a href="SimPowerlaw.html">SimPowerlaw</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Torben Kunz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate a power-law timeseries with no proxy archiving or measurement effects</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">1e04</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ts1</span> <span class="op">&lt;-</span> <span class="fu">SimProxySeries</span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.1</span>, b <span class="op">=</span> <span class="fl">1</span>, nt <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ts1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">ts1</span>, deltat <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ts1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimProxySeries-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="SpecMTM.html">SpecMTM</a></span><span class="op">(</span><span class="va">ts1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="LPlot.html">LPlot</a></span><span class="op">(</span><span class="va">sp1</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimProxySeries-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate the same climate timeseries (by setting seed the same) but with smoothing</span></span></span>
<span class="r-in"><span><span class="co">## from bioturbation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tau_b</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ts2</span> <span class="op">&lt;-</span> <span class="fu">SimProxySeries</span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.1</span>, b <span class="op">=</span> <span class="fl">1</span>, nt <span class="op">=</span> <span class="va">n</span>,</span></span>
<span class="r-in"><span> smth.arch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"bioturbation"</span>, tau <span class="op">=</span> <span class="va">tau_b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">ts2</span>, deltat <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ts1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts2</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimProxySeries-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="SpecMTM.html">SpecMTM</a></span><span class="op">(</span><span class="va">ts2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="LPlot.html">LPlot</a></span><span class="op">(</span><span class="va">sp1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">$</span><span class="va">spec</span>, <span class="va">sp2</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="LLines.html">LLines</a></span><span class="op">(</span><span class="va">sp2</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Then add measurement error</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ts3</span> <span class="op">&lt;-</span> <span class="fu">SimProxySeries</span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.1</span>, b <span class="op">=</span> <span class="fl">1</span>, nt <span class="op">=</span> <span class="va">n</span>,</span></span>
<span class="r-in"><span>smth.arch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"bioturbation"</span>, tau <span class="op">=</span> <span class="va">tau_b</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> var.noise <span class="op">=</span> <span class="fl">0.1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ts3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">ts3</span>, deltat <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="SpecMTM.html">SpecMTM</a></span><span class="op">(</span><span class="va">ts3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="LLines.html">LLines</a></span><span class="op">(</span><span class="va">sp3</span>, col <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">0.1</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sp3</span><span class="op">$</span><span class="va">freq</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimProxySeries-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## sample time series at arbitrary times</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' set.seed(1)</span></span></span>
<span class="r-in"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ts4</span> <span class="op">&lt;-</span> <span class="fu">SimProxySeries</span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.1</span>, b <span class="op">=</span> <span class="fl">1</span>, nt <span class="op">=</span> <span class="va">n</span>, t.smpl <span class="op">=</span> <span class="va">time</span>,</span></span>
<span class="r-in"><span>smth.arch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"bioturbation"</span>, tau <span class="op">=</span> <span class="va">tau_b</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> var.noise <span class="op">=</span> <span class="fl">0.1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">time</span>, ts4 <span class="op">=</span> <span class="va">ts4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ts4</span><span class="op">~</span><span class="va">time</span>, data <span class="op">=</span> <span class="va">dat</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimProxySeries-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: even though seed was set, these points will not be from the same</span></span></span>
<span class="r-in"><span><span class="co"># timeseries as ts3.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, generate the whole timeseries and subset at the desired</span></span></span>
<span class="r-in"><span><span class="co">## timepoints if integer timepoints are acceptable. This can often be faster</span></span></span>
<span class="r-in"><span><span class="co">## as it allows the fast FFT algorithm to be used.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ts3_sub</span> <span class="op">&lt;-</span> <span class="va">ts3</span><span class="op">[</span><span class="va">time</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ts1</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ts2</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">ts3_sub</span>, col <span class="op">=</span> <span class="st">"Orange"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">ts3_sub</span>, col <span class="op">=</span> <span class="st">"Orange"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimProxySeries-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Thomas Laepple, Thomas Muench, Andrew Dolman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

