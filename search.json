[{"path":"https://earthsystemdiagnostics.github.io/paleospec/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2019 Earth System Diagnostics group Alfred Wegener Institute Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Thomas Laepple. Author, maintainer. Thomas Muench. Author. Andrew Dolman. Author. Kira Rehfeld. Contributor. Torben Kunz. Contributor.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Laepple T, Muench T, Dolman (2025). PaleoSpec: Spectral tools ECUS group. R package version 0.33, https://earthsystemdiagnostics.github.io/paleospec/.","code":"@Manual{,   title = {PaleoSpec: Spectral tools for the ECUS group},   author = {Thomas Laepple and Thomas Muench and Andrew Dolman},   year = {2025},   note = {R package version 0.33},   url = {https://earthsystemdiagnostics.github.io/paleospec/}, }"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/index.html","id":"paleospec","dir":"","previous_headings":"","what":"Spectral tools for the ECUS group","title":"Spectral tools for the ECUS group","text":"PaleoSpec R package assist spectral analysis timeseries, particular timeseries climate variables observational, model, proxy paleoclimate data sources. PaleoSpec contains functions analyse existing timeseries generate timeseries specific spectral properties.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spectral tools for the ECUS group","text":"can install development version PaleoSpec GitHub : Please refer function references : https://earthsystemdiagnostics.github.io/paleospec/reference/index.html","code":"# install.packages(\"remotes\") remotes::install_github(\"EarthSystemDiagnostics/paleospec\")"},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/index.html","id":"estimating-power-spectra","dir":"","previous_headings":"Usage","what":"Estimating power spectra","title":"Spectral tools for the ECUS group","text":"SpecMTM can used estimate power spectrum timeseries using multitaper method. estimate spectrum monthly sunspot data comes R. sunspot data already timeseries object SpecMTM knows correct frequency observations. can plot power spectrum PaleoSpec function LPlot.   Alternatively can use gg_spec() function get ggplot2  Appproximate confidence intervals can added function AddConfInterval()","code":"sunspot <- datasets::sunspot.month plot(sunspot) library(PaleoSpec) sp_sun <- SpecMTM(sunspot) LPlot(sp_sun) gg_spec(sp_sun) #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. sp_sun <- AddConfInterval(sp_sun) gg_spec(sp_sun) #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale."},{"path":"https://earthsystemdiagnostics.github.io/paleospec/index.html","id":"simulating-timeseries-with-given-spectral-properties","dir":"","previous_headings":"Usage","what":"Simulating timeseries with given spectral properties","title":"Spectral tools for the ECUS group","text":"SimPLS can used create timeseries whose power spectrum powerlaw like properties, : S(f)=αf−βS(f) = \\alpha f^{-\\beta}  SpecMTM can used estimate power spectrum using multitaper method. convert vector SimPLS timeseries object, add information sampling frequency timeseries SpecMTM correct frequency axis.  can add confidence intervals spectral estimates AddConfInterval  LogSmooth function can used smooth power spectra equally spaced filter log-space.","code":"# setting the seed of the random number generator so that this example will  # always generate the same time series set.seed(20221109)  # length of the time series N <- 1e03  # parameters of the powerlaw spectrum alpha <- 0.1 beta <- 1  ts1 <- SimPLS(N = N, b = beta, a = alpha) plot(ts1, type = \"l\") sp1 <- SpecMTM(ts(ts1, deltat = 1))  LPlot(sp1) abline(log10(alpha), -beta, col = \"red\") sp1 <- AddConfInterval(sp1) LPlot(sp1) abline(log10(alpha), -beta, col = \"red\") sp1_f <- LogSmooth(sp1, df.log = 0.01) LPlot(sp1) LLines(sp1_f, col = \"green\")"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AddConfInterval.html","id":null,"dir":"Reference","previous_headings":"","what":"Add confidence interval — AddConfInterval","title":"Add confidence interval — AddConfInterval","text":"Calculated confidence intervals give interval within true spectrum lie frequency 1-p. behaviour changed version 0.33. Previous versions returned interval , applied 'true' spectrum, contain new spectral estimates frequency 1-p.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AddConfInterval.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add confidence interval — AddConfInterval","text":"","code":"AddConfInterval(spec, pval = 0.05, MINVALUE = 1e-10)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AddConfInterval.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add confidence interval — AddConfInterval","text":"spec spectral object class \"spec\" list minimum components spec dof vectors length giving spectral estimates corresponding degrees freedom. pval numeric; p value confidence interval, .e. interval constructed pval / 2 1 - pval / 2. MINVALUE numeric; minimum value limit confidence interval.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AddConfInterval.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add confidence interval — AddConfInterval","text":"input object including new list elements lim.1   lim.2 giving upper lower bound confidence interval,   respectively.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AddConfInterval.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add confidence interval — AddConfInterval","text":"Add confidence interval spectral estimate assuming uncertainty spectral estimates follows chi-squared distribution degrees freedom spectral estimates.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AddConfInterval.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Add confidence interval — AddConfInterval","text":"Thomas Laepple, Andrew Dolman","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AddConfInterval.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add confidence interval — AddConfInterval","text":"","code":"alpha <- 0.1 beta <- 1  spec_sim <- SpecMTM(ts(SimPLS(N = 1e03, beta = beta, alpha = alpha)))  # Using a large nominal p value of 0.25 to reduce variation between random # timeseries  # The true spec should be p/2 times above the lower CI, and p/2 below the upper CI  nominal_p <- 0.25 spec_sim <- AddConfInterval(spec_sim, pval = nominal_p) true_spec <- alpha * spec_sim$freq^-beta  LPlot(spec_sim) abline(a = log10(alpha), b = -beta, lty = 2, col = \"red\")   SpecCoverage <- function(spec, true_spec){    stopifnot(\"lim.1\" %in% names(spec))    n <- length(spec$freq)   below <- sum(spec$lim.1 < true_spec)   above <- sum(spec$lim.2 > true_spec)    total <- below + above    count <- list(n = n, above = above, below = below, total = total,                 p_above = above / n, p_below = below / n,                 p_total = total / n,                 nominal_pval = spec$pval)    as.data.frame(count) }  SpecCoverage(spec_sim, true_spec) #>     n above below total p_above p_below p_total nominal_pval #> 1 500    51    44    95   0.102   0.088    0.19         0.25"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AnPowerlaw.html","id":null,"dir":"Reference","previous_headings":"","what":"A PSD(freq) for a powerlaw with variance 1 — AnPowerlaw","title":"A PSD(freq) for a powerlaw with variance 1 — AnPowerlaw","text":"PSD(freq) powerlaw variance 1","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AnPowerlaw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A PSD(freq) for a powerlaw with variance 1 — AnPowerlaw","text":"","code":"AnPowerlaw(beta, freq, return.scaling = FALSE)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AnPowerlaw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A PSD(freq) for a powerlaw with variance 1 — AnPowerlaw","text":"beta slope powerlaw freq frequency vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AnPowerlaw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A PSD(freq) for a powerlaw with variance 1 — AnPowerlaw","text":"vector containing PSD","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AnPowerlaw.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"A PSD(freq) for a powerlaw with variance 1 — AnPowerlaw","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApplyFilter.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter time series — ApplyFilter","title":"Filter time series — ApplyFilter","text":"Apply given filter time series using different endpoint constraints.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApplyFilter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter time series — ApplyFilter","text":"","code":"ApplyFilter(data, filter, method = 0, na.rm = FALSE)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApplyFilter.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Filter time series — ApplyFilter","text":"endpoint constraint methods based study:   Michael E. Mann, smoothing potentially non‐stationary climate time   series, Geophys. Res. Lett., 31, L07214, doi:10.1029/2004GL019569, 2004.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApplyFilter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter time series — ApplyFilter","text":"data numeric vector input timeseries (standard ts object). filter numeric vector filter weights. method single integer choosing endpoint constraint method; available choices integers 0-4, see details. na.rm logical; control handling internal NA values data. set TRUE, internal NA values removed linear interpolation neighbouring values; defaults FALSE.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApplyFilter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter time series — ApplyFilter","text":"ts object filtered timeseries.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApplyFilter.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter time series — ApplyFilter","text":"Note passing objects class ts, time step provided used; thus, time series time step different 1, filter adapted accordingly. Leading trailing NA values automatically stripped input vector spread filtered data applying endpoint constraints, added filtering output vector length input. apply internal NA values, instead handled na.rm. function applies endpoint constrains following Mann et al., GRL, 2004; available methods : method = 0: constraint (loss ends); method = 1: minimum norm constraint; method = 2: minimum slope constraint; method = 3: minimum roughness constraint; method = 4: circular filtering.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApplyFilter.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Filter time series — ApplyFilter","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApplyFilter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter time series — ApplyFilter","text":"","code":"# Simple running mean filter across three bins  x <- 1 : 10 filter <- rep(1 / 3, 3)  # no endpoint constraints lead to loss at both ends ApplyFilter(x, filter, method = 0) #> Time Series: #> Start = 1  #> End = 10  #> Frequency = 1  #>  [1] NA  2  3  4  5  6  7  8  9 NA  # circular filtering avoids end losses, so as the other methods ApplyFilter(x, filter, method = 4) #> Time Series: #> Start = 1  #> End = 10  #> Frequency = 1  #>  [1] 4.333333 2.000000 3.000000 4.000000 5.000000 6.000000 7.000000 8.000000 #>  [9] 9.000000 6.666667  # leading and trailing NA's are ignored but added in again afterwards x <- c(NA, 1 : 10, NA) ApplyFilter(x, filter, method = 4) #> Time Series: #> Start = 1  #> End = 12  #> Frequency = 1  #>  [1]       NA 4.333333 2.000000 3.000000 4.000000 5.000000 6.000000 7.000000 #>  [9] 8.000000 9.000000 6.666667       NA  # ... but not internal NA's x <- c(1 : 5, NA, 7 : 10) ApplyFilter(x, filter, method = 4) #> Time Series: #> Start = 1  #> End = 10  #> Frequency = 1  #>  [1] 4.333333 2.000000 3.000000 4.000000       NA       NA       NA 8.000000 #>  [9] 9.000000 6.666667  # if not explicitly removed by linear interpolation ApplyFilter(x, filter, method = 4, na.rm = TRUE) #> Time Series: #> Start = 1  #> End = 10  #> Frequency = 1  #>  [1] 4.333333 2.000000 3.000000 4.000000 5.000000 6.000000 7.000000 8.000000 #>  [9] 9.000000 6.666667   # Visual comparison of methods ---------- set.seed(20220302)  x <- PaleoSpec::SimPowerlaw(1, 1e02) x <- x + 0.1 * (1:length(x))  filt <- rep(1/30, 30)  plot(x, type = \"l\")  x0 <- ApplyFilter(x, filt, method = 0) lines(x0, col = \"Green\")  x1 <- ApplyFilter(x, filt, method = 1) lines(x1, col = \"blue\")  x2 <- ApplyFilter(x, filt, method = 2) lines(x2, col = \"red\")  x3 <- ApplyFilter(x, filt, method = 3) lines(x3, col = \"orange\")  x4 <- ApplyFilter(x, filt, method = 4) lines(x4, col = \"Purple\", lty = 2)  lines(x0, col = \"Green\")  legend(x = \"topleft\",        legend = c(\"0: no constraint (lose ends)\",                   \"1: min norm (pad with mean)\",                   \"2: min slope (reflect ends)\",                   \"3: min roughness (reflect and invert ends)\",                   \"4: circular\"),        col = c(\"Green\", \"Blue\", \"Red\", \"Orange\", \"Purple\"),        lwd = 2, lty = c(1,1,1,1,2))    # Repeat with linear trend, no noise  x <- 1:100 filt <- rep(1/30, 30)  plot(x, type = \"l\")  x0 <- ApplyFilter(x, filt, method = 0) lines(x0, col = \"Green\")  x1 <- ApplyFilter(x, filt, method = 1) lines(x1, col = \"blue\")  x2 <- ApplyFilter(x, filt, method = 2) lines(x2, col = \"red\")  x3 <- ApplyFilter(x, filt, method = 3) lines(x3, col = \"orange\")  x4 <- ApplyFilter(x, filt, method = 4) lines(x4, col = \"Purple\", lty = 2)  lines(x0, col = \"Green\")  legend(x = \"topleft\",        legend = c(\"0: no constraint (lose ends)\",                   \"1: min norm (pad with mean)\",                   \"2: min slope (reflect ends)\",                   \"3: min roughness (reflect and invert ends)\",                   \"4: circular\"),        col = c(\"Green\", \"Blue\", \"Red\", \"Orange\", \"Purple\"),        lwd = 2, lty = c(1,1,1,1,2))"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApproxNearest.html","id":null,"dir":"Reference","previous_headings":"","what":"approximate a timeseries using the nearest neighbour — ApproxNearest","title":"approximate a timeseries using the nearest neighbour — ApproxNearest","text":"extends approx always takes right left neighbour weighted mean f>0<1","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApproxNearest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"approximate a timeseries using the nearest neighbour — ApproxNearest","text":"","code":"ApproxNearest(x, y, xout, rule = 1)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApproxNearest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"approximate a timeseries using the nearest neighbour — ApproxNearest","text":"x numeric vector giving coordinates points interpolate y corresponding y values xout set numeric values specifying interpolation take place. rule integer (length 1 2) describing interpolation take place outside interval see ?approx","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApproxNearest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"approximate a timeseries using the nearest neighbour — ApproxNearest","text":"list components 'x' 'y', containing length(xouth) coordinates interpolate given data points","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApproxNearest.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"approximate a timeseries using the nearest neighbour — ApproxNearest","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ApproxNearest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"approximate a timeseries using the nearest neighbour — ApproxNearest","text":"","code":"x<-1:10 y<-1:10 xout<-seq(from=0,to=11,by=0.01) plot(x,y,type=\"b\",pch=19,xlim=range(xout)) result<-ApproxNearest(x,y,xout) lines(result,col=\"red\")"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AvgToBin.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin averaging — AvgToBin","title":"Bin averaging — AvgToBin","text":"Average vector bins.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AvgToBin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin averaging — AvgToBin","text":"","code":"AvgToBin(x, y, N = 2, breaks = pretty(x, N), right = TRUE, bFill = FALSE)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AvgToBin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin averaging — AvgToBin","text":"x vector values data y tabulated; e.g. depth time points. y vector observation values averaged bins. Must length x. N desired number breaks (ignored breaks supplied directly). breaks vector break point positions define averagig bins; omitted, break point positions calculated range x desired number breaks given N. right logical; indicate whether bin intervals closed right open left (TRUE, default), vice versa (FALSE). bFill logical; TRUE, fill empty bins using linear interpolation neighbours center bin.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AvgToBin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin averaging — AvgToBin","text":"list four elements: breaks: numeric vector used break point positions. centers: numeric vector positions bin centers. avg: numeric vector bin-averaged values. nobs: numeric vector number observations   contributing bin average.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AvgToBin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bin averaging — AvgToBin","text":"function averages vector y bins according positon x within breaks. can either specify desired number N breaks used calculate actual breaks via pretty(x, N), directly specify N + 1 break positions. right = TRUE (default) averaging bins defined via x > breaks[] x <= breaks[+ 1], else defined via x >= breaks[] x < breaks[+ 1]. bFill = TRUE, empty bins filled using linear interpolation neighbours center bin. Probably binning considerably speeded using ?cut.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AvgToBin.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bin averaging — AvgToBin","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/AvgToBin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bin averaging — AvgToBin","text":"","code":"N <- 100 x1 <- seq(1, N, by = 1) y1 <- SimPLS(N, a = 0.1, b = 1) plot(x1, y1, type = \"l\")  y2 <- AvgToBin(x1, y1, 13) lines(y2$centers, y2$avg, col = \"green\")   #Add some NA values to the timeseries y1[(N/2):(N/2 +5)] <- NA plot(x1, y1, type = \"l\")  y2 <- AvgToBin(x1, y1, 25) lines(y2$centers, y2$avg, col = \"green\")  # Large enough bins will average across the gap y3 <- AvgToBin(x1, y1, 10) lines(y3$centers, y3$avg, col = \"red\") # Or interpolate to nearest neighbour y3 <- AvgToBin(x1, y1, 25, bFill = TRUE) lines(y3$centers, y3$avg, col = \"blue\")"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Bandpass.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Weights for a Bandpass Filter — Bandpass","title":"Calculate Weights for a Bandpass Filter — Bandpass","text":"Derive (smoothed) least square bandpass based Bloomfield 1976","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Bandpass.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Weights for a Bandpass Filter — Bandpass","text":"","code":"Bandpass(omega.upper, omega.lower, n, sample = 1, convergence = T)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Bandpass.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Weights for a Bandpass Filter — Bandpass","text":"omega.upper upper cutoff frequency omega.lower lower cutoff frequency n length filter, odd sample sampling rate timeseries filter applied (1/deltat) convergence TRUE: smoothed least square lowpass; FALSE = unsmoothed","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Bandpass.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Weights for a Bandpass Filter — Bandpass","text":"vector filter weights","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Bandpass.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate Weights for a Bandpass Filter — Bandpass","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/BinTimeseries.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin a Timeseries Preserving Empty Bins — BinTimeseries","title":"Bin a Timeseries Preserving Empty Bins — BinTimeseries","text":"Convert continuous time series discrete (regular)   timeseries binning, preserving empty bins. Additionally returns   number data points bin","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/BinTimeseries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin a Timeseries Preserving Empty Bins — BinTimeseries","text":"","code":"BinTimeseries(   time.var,   value.var,   bin.width,   strt.time = NULL,   end.time = NULL )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/BinTimeseries.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin a Timeseries Preserving Empty Bins — BinTimeseries","text":"time.var time variable, vector value.var value variable, vector bin.width time bins output strt.time first time value output, defaults min(time.var) - bin.width/2 end.time last time values output, defaults max(time.var) + bin.width/2","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/BinTimeseries.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin a Timeseries Preserving Empty Bins — BinTimeseries","text":"dataframe","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/BinTimeseries.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bin a Timeseries Preserving Empty Bins — BinTimeseries","text":"Andrew Dolman <andrew.dolman@awi.de>","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/BinTimeseries.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bin a Timeseries Preserving Empty Bins — BinTimeseries","text":"","code":"set.seed(20230312) x <- cumsum(rgamma(20, shape = 1.5, rate = 1.5/10)) y <- SimProxySeries(a = 0.1, b = 1, t.smpl = x) BinTimeseries(x, y, bin.width = 15) #>            time       bin  mean.time  mean.value n.bin bin.width #> (-1,14]     6.5   (-1,14]   8.911319  1.23548087     2        15 #> (14,29]    21.5   (14,29]  23.495638  0.30035676     3        15 #> (29,44]    36.5   (29,44]  37.454106 -0.36173796     2        15 #> (44,59]    51.5   (44,59]  52.761917 -0.18800400     2        15 #> (59,74]    66.5   (59,74]         NA          NA    NA        15 #> (74,89]    81.5   (74,89]         NA          NA    NA        15 #> (89,104]   96.5  (89,104] 102.185214  0.63839240     1        15 #> (104,119] 111.5 (104,119] 105.004541  1.47705385     1        15 #> (119,134] 126.5 (119,134] 127.412123  0.29789540     2        15 #> (134,149] 141.5 (134,149] 143.144083  0.25594339     2        15 #> (149,164] 156.5 (149,164] 156.682514  0.40732420     1        15 #> (164,179] 171.5 (164,179] 170.969416 -0.58650218     3        15 #> (179,194] 186.5 (179,194] 182.204167  0.04149092     1        15"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ClosestElement.html","id":null,"dir":"Reference","previous_headings":"","what":"Get closest element of a vector — ClosestElement","title":"Get closest element of a vector — ClosestElement","text":"Get closest element vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ClosestElement.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get closest element of a vector — ClosestElement","text":"","code":"ClosestElement(xvector, x, type = \"N\")"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ClosestElement.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get closest element of a vector — ClosestElement","text":"xvector vector values x value find closest match type methods N, M L","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ClosestElement.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get closest element of a vector — ClosestElement","text":"vector length 1","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ClosestElement.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get closest element of a vector — ClosestElement","text":"","code":"a <- 1:10 ClosestElement(a, 3.4) #> [1] 3"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ColTransparent.html","id":null,"dir":"Reference","previous_headings":"","what":"Modify a color to get brighter and tranparent for the confidence intervals — ColTransparent","title":"Modify a color to get brighter and tranparent for the confidence intervals — ColTransparent","text":"Modify color get brighter tranparent confidence intervals","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ColTransparent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Modify a color to get brighter and tranparent for the confidence intervals — ColTransparent","text":"","code":"ColTransparent(color, alpha = 0.8, beta = 150)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ColTransparent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Modify a color to get brighter and tranparent for the confidence intervals — ColTransparent","text":"color color value, e.g. \"red\" alpha (0..1) transparency value beta (0..255) make brighter, value gets added RGB values","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ColTransparent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Modify a color to get brighter and tranparent for the confidence intervals — ColTransparent","text":"modified color","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ColTransparent.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Modify a color to get brighter and tranparent for the confidence intervals — ColTransparent","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfRatio.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence Interval of ratios — ConfRatio","title":"Confidence Interval of ratios — ConfRatio","text":"Confidence Interval ratios based ChiSquare Distribution","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfRatio.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence Interval of ratios — ConfRatio","text":"","code":"ConfRatio(varratio, df.1, df.2, pval = 0.1)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfRatio.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence Interval of ratios — ConfRatio","text":"varratio variance ratio df.1 degree freedom denominator df.2 degree freedom numerator pval desired significance level, defaults 0.1","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfRatio.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence Interval of ratios — ConfRatio","text":"lower upper confidence intervals","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfRatio.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Confidence Interval of ratios — ConfRatio","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfVar.html","id":null,"dir":"Reference","previous_headings":"","what":"Provide ChiSquared confidence intervals for ratios — ConfVar","title":"Provide ChiSquared confidence intervals for ratios — ConfVar","text":"Provide ChiSquared confidence intervals ratios","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfVar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Provide ChiSquared confidence intervals for ratios — ConfVar","text":"","code":"ConfVar(varlist, pval = 0.05)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfVar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Provide ChiSquared confidence intervals for ratios — ConfVar","text":"varlist list(var,dof) pval requested p-value","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfVar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Provide ChiSquared confidence intervals for ratios — ConfVar","text":"Output: confidence intervals","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/ConfVar.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Provide ChiSquared confidence intervals for ratios — ConfVar","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/DF2Spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform a spec_df Object into a spec Object or List of spec Objects — DF2Spec","title":"Transform a spec_df Object into a spec Object or List of spec Objects — DF2Spec","text":"Transform spec_df Object spec Object List spec Objects","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/DF2Spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform a spec_df Object into a spec Object or List of spec Objects — DF2Spec","text":"","code":"DF2Spec(spec_df)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/DF2Spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform a spec_df Object into a spec Object or List of spec Objects — DF2Spec","text":"spec_df spec_df object","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/DF2Spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform a spec_df Object into a spec Object or List of spec Objects — DF2Spec","text":"spec object list spec objects","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/DF2Spec.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Transform a spec_df Object into a spec Object or List of spec Objects — DF2Spec","text":"Andrew Dolman <andrew.dolman@awi.de>","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/DF2Spec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform a spec_df Object into a spec Object or List of spec Objects — DF2Spec","text":"","code":"library(PaleoSpec) ts1 <- ts(SimPLS(1000, beta = 1)) sp1 <- SpecMTM(ts1) ts2 <- ts(rnorm(1000)) sp2 <- SpecMTM(ts2) sp_lst <- list(sp1 = sp1, sp2 = sp2) sp_df <- Spec2DF(sp_lst) sp_df #> # A tibble: 1,000 × 4 #>    spec_id  freq  spec   dof #>    <chr>   <dbl> <dbl> <dbl> #>  1 sp1     0.001 13.6   5.99 #>  2 sp1     0.002 20.2   5.99 #>  3 sp1     0.003 10.2   5.99 #>  4 sp1     0.004 11.5   5.99 #>  5 sp1     0.005  8.41  5.97 #>  6 sp1     0.006  2.68  5.95 #>  7 sp1     0.007  2.55  5.88 #>  8 sp1     0.008  6.24  5.96 #>  9 sp1     0.009  9.54  5.99 #> 10 sp1     0.01   8.86  5.98 #> # ℹ 990 more rows str(DF2Spec(sp_df)) #> List of 2 #>  $ sp1:List of 4 #>   ..$ spec_id: chr [1:500] \"sp1\" \"sp1\" \"sp1\" \"sp1\" ... #>   ..$ freq   : num [1:500] 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01 ... #>   ..$ spec   : num [1:500] 13.57 20.19 10.18 11.52 8.41 ... #>   ..$ dof    : num [1:500] 5.99 5.99 5.99 5.99 5.97 ... #>   ..- attr(*, \"class\")= chr [1:2] \"spec\" \"list\" #>  $ sp2:List of 4 #>   ..$ spec_id: chr [1:500] \"sp2\" \"sp2\" \"sp2\" \"sp2\" ... #>   ..$ freq   : num [1:500] 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01 ... #>   ..$ spec   : num [1:500] 0.69 1.148 1.694 0.862 1.273 ... #>   ..$ dof    : num [1:500] 5.75 5.84 5.9 5.79 5.86 ... #>   ..- attr(*, \"class\")= chr [1:2] \"spec\" \"list\" #>  - attr(*, \"class\")= chr [1:2] \"list\" \"spec_list\""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpec.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter a Power Spectrum Object — FilterSpec","title":"Filter a Power Spectrum Object — FilterSpec","text":"Filter Power Spectrum Object","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter a Power Spectrum Object — FilterSpec","text":"","code":"FilterSpec(spec, spans, method = 3, keep_low_f = TRUE)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter a Power Spectrum Object — FilterSpec","text":"spec spec object spans vector odd integers giving widths modified     Daniell smoothers used smooth periodogram. method single integer choosing endpoint constraint method. Available choices integers 0-4, see details ApplyFilter keep_low_f Keep filtered (smoothed) low frequencies replace unfiltered","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter a Power Spectrum Object — FilterSpec","text":"spec object (list)","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpec.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Filter a Power Spectrum Object — FilterSpec","text":"Andrew Dolman","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter a Power Spectrum Object — FilterSpec","text":"","code":"## Comparison of the four methods - for power spectra, methods 0, 2 or 3 make the most sense library(PaleoSpec)  a <- 100 b <- 1 N <- 1e03 set.seed(20230625) ts1 <- SimPLS(N, beta = b, alpha = a) sp1 <- SpecMTM(ts(ts1), bin.width = 1) LPlot(sp1) abline(log10(a), -b, col = \"green\")  fl <- seq(3, 9, by = 2) sp1_f3_0 <- FilterSpec(sp1, spans = fl, method = 0) sp1_f3_1 <- FilterSpec(sp1, spans = fl, method = 1) sp1_f3_2 <- FilterSpec(sp1, spans = fl, method = 2) sp1_f3_3 <- FilterSpec(sp1, spans = fl, method = 3) sp1_f3_4 <- FilterSpec(sp1, spans = fl, method = 4)  LPlot(sp1) LLines(sp1_f3_0, col = \"blue\") LLines(sp1_f3_1, col = \"green\", lty = 2) LLines(sp1_f3_2, col = \"red\", lty = 3) LLines(sp1_f3_3, col = \"orange\", lty = 4) LLines(sp1_f3_4, col = \"gold\", lty = 5)   ## Comparison of keeping the filtered values in the reflected end portions or not sp1_f3_0T <- FilterSpec(sp1, spans = fl, method = 0, keep_low_f = TRUE) sp1_f3_0F <- FilterSpec(sp1, spans = fl, method = 0, keep_low_f = FALSE) LPlot(sp1_f3_0F) LLines(sp1_f3_0T, col = \"red\")  sp1_f3_2T <- FilterSpec(sp1, spans = fl, method = 2, keep_low_f = TRUE) sp1_f3_2F <- FilterSpec(sp1, spans = fl, method = 2, keep_low_f = FALSE) LPlot(sp1_f3_2F) LLines(sp1_f3_2T, col = \"red\")"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpecLog.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth a Spectrum with Evenly Spaced Bins in Logspace — FilterSpecLog","title":"Smooth a Spectrum with Evenly Spaced Bins in Logspace — FilterSpecLog","text":"Smooth Spectrum Evenly Spaced Bins Logspace","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpecLog.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth a Spectrum with Evenly Spaced Bins in Logspace — FilterSpecLog","text":"","code":"FilterSpecLog(spec, df.log = 0.05, spans = NULL, method = 3, f.res = 10)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpecLog.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth a Spectrum with Evenly Spaced Bins in Logspace — FilterSpecLog","text":"spec spec object df.log width smoother log units method single integer choosing endpoint constraint method. Available choices integers 0-4, see details ApplyFilter","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpecLog.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth a Spectrum with Evenly Spaced Bins in Logspace — FilterSpecLog","text":"spec object (list)","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpecLog.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Smooth a Spectrum with Evenly Spaced Bins in Logspace — FilterSpecLog","text":"Andrew Dolman","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FilterSpecLog.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smooth a Spectrum with Evenly Spaced Bins in Logspace — FilterSpecLog","text":"","code":"library(PaleoSpec)  # simulate a timeseries with powerlaw power spectrum a <- 100 b <- 1 N <- 1e03  set.seed(20230625) ts1 <- SimPLS(N, beta = b, alpha = a) sp1 <- SpecMTM(ts(ts1), bin.width = 1) LPlot(sp1) abline(log10(a), -b, col = \"green\")  # sp1_f3_0 <- FilterSpecLog(sp1, method = 0) sp1_f3_2 <- FilterSpecLog(sp1, method = 2)  LPlot(sp1) LLines(sp1_f3_0, col = \"blue\") LLines(sp1_f3_2, col = \"green\", lty = 3)   sp1_df0.05 <- FilterSpecLog(sp1) sp1_df0.1 <- FilterSpecLog(sp1, df.log = 0.1)  LPlot(sp1) LLines(sp1_df0.05, col = \"blue\") LLines(sp1_df0.1, col = \"red\")   ## A combination of FilterSpec and FilterSpecLog  sp1_FSL <- FilterSpecLog(sp1) sp1_FSL_FS <- FilterSpec(FilterSpecLog(sp1), spans = c(3, 5)) sp1_FS_FSL <- FilterSpecLog(FilterSpec(sp1, spans = c(3, 5))) LPlot(sp1) LLines(sp1_FSL, col = \"blue\") LLines(sp1_FSL_FS, col = \"red\") LLines(sp1_FS_FSL, col = \"green\")"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FirstElement.html","id":null,"dir":"Reference","previous_headings":"","what":"first element of a vector — FirstElement","title":"first element of a vector — FirstElement","text":"first element vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FirstElement.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"first element of a vector — FirstElement","text":"","code":"FirstElement(x)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FirstElement.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"first element of a vector — FirstElement","text":"x vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FirstElement.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"first element of a vector — FirstElement","text":"first element X","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/FirstElement.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"first element of a vector — FirstElement","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetTransferFunction.html","id":null,"dir":"Reference","previous_headings":"","what":"Derives and plots the transfer function (given a filter) — GetTransferFunction","title":"Derives and plots the transfer function (given a filter) — GetTransferFunction","text":"Get transfer function symetric filter, page 122 Bloomfield 1976, page 135 Bloomfield 2000","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetTransferFunction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derives and plots the transfer function (given a filter) — GetTransferFunction","text":"","code":"GetTransferFunction(   g.u,   resolution = 100,   freq = NULL,   bPlot = is.null(freq) == TRUE,   add = FALSE,   ... )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetTransferFunction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derives and plots the transfer function (given a filter) — GetTransferFunction","text":"g.u filter, numeric vector, values sum 1 resolution number frequencies evaluate transfer function freq specific frequency(s) evaluate transfer function NULL, transfer function evaluated 1:resolution frequencies bPlot logical, plot transfer function, defaults FALSE frequencies specified, TRUE otherwise add logical, add previous plot ... arguments pass plotting function","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetTransferFunction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derives and plots the transfer function (given a filter) — GetTransferFunction","text":"list(freq, y) containing transfer function","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetTransferFunction.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Derives and plots the transfer function (given a filter) — GetTransferFunction","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetTransferFunction.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Derives and plots the transfer function (given a filter) — GetTransferFunction","text":"","code":"l <- 11 tf <- GetTransferFunction(rep(1/l, l), resolution = 1000)  tf <- GetTransferFunction(rep(1/l, l), freq = 1/c(100, 10, 2))"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetVarFromSpectra.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance estimate by integrating a part of the spectrum — GetVarFromSpectra","title":"Variance estimate by integrating a part of the spectrum — GetVarFromSpectra","text":"Variance estimate integrating part spectrum","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetVarFromSpectra.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance estimate by integrating a part of the spectrum — GetVarFromSpectra","text":"","code":"GetVarFromSpectra(spec, f, dfreq = NULL, df.log = 0, bw = 3)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetVarFromSpectra.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance estimate by integrating a part of the spectrum — GetVarFromSpectra","text":"spec spectrum (list spec,freq,dof) analysed f f[1],f[2]: frequency interval analysed dfreq frequency discretisation used temporary  interpolation df.log > 0, smooth spectra prior integrating bw bandwidth assumed confinterval calculation (multitaper spectral estimate)","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetVarFromSpectra.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variance estimate by integrating a part of the spectrum — GetVarFromSpectra","text":"list(var,dof)  variance corresponding dof","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetVarFromSpectra.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Variance estimate by integrating a part of the spectrum — GetVarFromSpectra","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/GetVarFromSpectra.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variance estimate by integrating a part of the spectrum — GetVarFromSpectra","text":"","code":"x<-ts(rnorm(100)) spec<-SpecMTM(x) var(x) #Sample variance of the timeseries #> [1] 1.069597 GetVarFromSpectra(spec,c(1/100,0.5)) #> $var #> [1] 0.9984553 #>  #> $dof #> [1] 94.54199 #>  GetVarFromSpectra(spec,c(0.25,0.5)) #> $var #> [1] 0.5067319 #>  #> $dof #> [1] 48.0935 #>"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Highpass.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate weights for a bandpass filter — Highpass","title":"calculate weights for a bandpass filter — Highpass","text":"Derive (smoothed) least square highpass based Bloomfield 1976","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Highpass.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate weights for a bandpass filter — Highpass","text":"","code":"Highpass(omega.c, n = 9, sample = 1, convergence = T)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Highpass.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate weights for a bandpass filter — Highpass","text":"omega.c cutoff frequency n length filter, odd sample sampling rate timeseries filter applied (1/deltat) convergence TRUE: smoothed least square lowpass; FALSE = unsmoothed","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Highpass.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate weights for a bandpass filter — Highpass","text":"vector filter weights","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Highpass.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"calculate weights for a bandpass filter — Highpass","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/InverseFilter.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct the inverse filter in the time domain — InverseFilter","title":"Construct the inverse filter in the time domain — InverseFilter","text":"Construct inverse filter time domain","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/InverseFilter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct the inverse filter in the time domain — InverseFilter","text":"","code":"InverseFilter(filter.weights)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/InverseFilter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct the inverse filter in the time domain — InverseFilter","text":"filter.weights","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/InverseFilter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct the inverse filter in the time domain — InverseFilter","text":"filter weights inverse filter","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/InverseFilter.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Construct the inverse filter in the time domain — InverseFilter","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LLines.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a spectrum to an existing log-log spectral plot. — LLines","title":"Add a spectrum to an existing log-log spectral plot. — LLines","text":"function adds spectrum existing double-logarithmic plot optionally adds transparent confidence interval.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LLines.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a spectrum to an existing log-log spectral plot. — LLines","text":"","code":"LLines(   x,   conf = TRUE,   bPeriod = FALSE,   col = \"black\",   alpha = 0.3,   removeFirst = 0,   removeLast = 0,   ... )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LLines.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a spectrum to an existing log-log spectral plot. — LLines","text":"x spectral object resulting call SpecMTM. conf TRUE (default) add transparent confidence interval (suppressed x contains error limits). bPeriod TRUE x-axis displayed units period (inverse frequency), increasing left. Defaults FALSE. col color line plot confidence interval. alpha transparency level (0 1) confidence interval. Defaults 0.3. removeFirst omit removeFirst values low frequency side. removeLast omit removeLast values high frequency side. ... graphical parameters passed lines.","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LLines.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Add a spectrum to an existing log-log spectral plot. — LLines","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LLines.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add a spectrum to an existing log-log spectral plot. — LLines","text":"","code":"x <- ts(arima.sim(list(ar = 0.9), 1000)) spec <- SpecMTM(x) LPlot(spec, col = \"grey\") LLines(LogSmooth(spec), lwd = 2)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Log-log spectral plot. — LPlot","title":"Log-log spectral plot. — LPlot","text":"function plots spectrum double-logarithmic scale  optionally adds transparent confidence interval.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log-log spectral plot. — LPlot","text":"","code":"LPlot(   x,   conf = TRUE,   bPeriod = FALSE,   bNoPlot = FALSE,   axes = TRUE,   col = \"black\",   alpha = 0.3,   removeFirst = 0,   removeLast = 0,   xlab = \"f\",   ylab = \"PSD\",   xlim = NULL,   ylim = NULL,   log = \"xy\",   ... )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log-log spectral plot. — LPlot","text":"x spectral object resulting call SpecMTM. conf TRUE (default) add transparent confidence interval (suppressed x contains error limits). bPeriod TRUE x-axis displayed units period (inverse frequency), increasing left. Defaults FALSE. bNoPlot TRUE produce plot frame (type = \"n\" behaviour function plot). Defaults FALSE. axes FALSE plotting x y axes suppressed. Defaults TRUE. col color line plot confidence interval. alpha transparency level (0 1) confidence interval. Defaults 0.3. removeFirst omit removeFirst values low frequency side. removeLast omit removeLast values high frequency side. xlab character string labelling x-axis. ylab character string labelling y-axis. xlim range x-axis values; NULL (default) calculated internally automatically reversed bPeriod = TRUE. ylim range y-axis values; NULL (default) calculated internally. log character string contains \"x\" x axis     logarithmic, \"y\" y axis logarithmic     \"xy\" \"yx\" axes logarithmic. ... graphical parameters passed plot.","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LPlot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Log-log spectral plot. — LPlot","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Log-log spectral plot. — LPlot","text":"","code":"x <- ts(arima.sim(list(ar = 0.9), 1000)) spec <- SpecMTM(x) LPlot(spec, col = \"grey\") LLines(LogSmooth(spec), lwd = 2)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LastElement.html","id":null,"dir":"Reference","previous_headings":"","what":"last element of a vector — LastElement","title":"last element of a vector — LastElement","text":"last element vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LastElement.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"last element of a vector — LastElement","text":"","code":"LastElement(x)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LastElement.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"last element of a vector — LastElement","text":"x","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LastElement.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"last element of a vector — LastElement","text":"last element X","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LastElement.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"last element of a vector — LastElement","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LogSmooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooths the spectrum using a log smoother — LogSmooth","title":"Smooths the spectrum using a log smoother — LogSmooth","text":"Smooths spectrum using log smoother","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LogSmooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooths the spectrum using a log smoother — LogSmooth","text":"","code":"LogSmooth(   spectra,   df.log = 0.05,   removeFirst = 0,   removeLast = 0,   bLog = FALSE )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LogSmooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooths the spectrum using a log smoother — LogSmooth","text":"spectra spectra: list(spec,freq) spec[specIndex]: spectra density vector freq[specIndex]: frequency vector df.log width smoother log units removeFirst elements remove slow side (one element recommended detrending) removeLast elements remove fast side bLog TRUE: average log space power, FALSE: arithmetic average","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LogSmooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooths the spectrum using a log smoother — LogSmooth","text":"smoothed spectrum","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LogSmooth.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Smooths the spectrum using a log smoother — LogSmooth","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/LogSmooth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smooths the spectrum using a log smoother — LogSmooth","text":"","code":"x<-ts(arima.sim(list(ar = 0.9),1000)) spec<-SpecMTM(x) LPlot(spec,col='grey') LLines(LogSmooth(spec,df.log=0.01),lwd=2,col='green') LLines(LogSmooth(spec,df.log=0.05),lwd=2,col='blue') LLines(LogSmooth(spec,df.log=0.1),lwd=2,col='red') legend('bottomleft', col=c('grey','green','blue','red'), lwd=2,c('raw','smoothed 0.01',  'smoothed 0.05', 'smoothed 0.1'), bty='n')   # Removal of lower (first) and higher (last) frequencies LPlot(spec,col='grey') LLines(LogSmooth(spec,df.log=0.01, removeFirst = 1),lwd=2,col='green') LLines(LogSmooth(spec,df.log=0.05, removeLast = 20),lwd=2,col='blue') LLines(LogSmooth(spec,df.log=0.1, removeFirst = 3, removeLast = 20),lwd=2,col='red')"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Lowpass.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate weights for lowpass filter — Lowpass","title":"Calculate weights for lowpass filter — Lowpass","text":"Derive (smoothed) least square lowpass, given cutoff frequency omega.c length filter n based Bloomfield 1976","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Lowpass.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate weights for lowpass filter — Lowpass","text":"","code":"Lowpass(omega.c, n = 9, sample = 1, convergence = TRUE)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Lowpass.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate weights for lowpass filter — Lowpass","text":"omega.c cutoff frequency n length filter, odd sample sampling rate timeseries filter applied (1/deltat) convergence TRUE: smoothed least square lowpass; FALSE = unsmoothed","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Lowpass.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate weights for lowpass filter — Lowpass","text":"vector filter weights","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Lowpass.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate weights for lowpass filter — Lowpass","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MakeEquidistant.html","id":null,"dir":"Reference","previous_headings":"","what":"Average an irregular timeseries to a regular timeseries — MakeEquidistant","title":"Average an irregular timeseries to a regular timeseries — MakeEquidistant","text":"Make irregular timeseries equidistant interpolating high resolution, lowpass filtering Nyquist frequency, subsampling; e.g. used Huybers Laepple, EPSL 2014","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MakeEquidistant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Average an irregular timeseries to a regular timeseries — MakeEquidistant","text":"","code":"MakeEquidistant(   t.x,   t.y,   dt = NULL,   time.target = seq(from = t.x[1], to = t.x[length(t.x)], by = dt),   dt.hres = NULL,   bFilter = TRUE,   k = 5,   kf = 1.2,   method.interpolation = \"linear\",   method.filter = 2 )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MakeEquidistant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Average an irregular timeseries to a regular timeseries — MakeEquidistant","text":"t.x vector timepoints t.y vector corresponding values dt target timestep; can omitted time.target supplied time.target time vector timeseries averaged/interpolated default range t.x timestep dt dt.hres timestep intermediate high-resolution interpolation. smaller smallest timestep bFilter (TRUE) low passs filter data avoid aliasing, (FALSE) just interpolate k scaling factor Length filter (increasing creates sharper filter, thus less aliasing) kf scaling factor lowpass frequency; 1 = Nyquist, 1.2 = 1.2xNyquist tradeoff reducing variance loss keeping aliasing small method.interpolation 'linear' 'constant', see approx method.filter avoid loosing data ends dataset, endpoint constrains used (see ApplyFilter) constraint (loss ends) (method=0), works t.x covers time time.target minimum norm constraint (method=1) minimum slope constraint (method=2) minimum roughness constraint (method=3) circular filtering (method=4)","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MakeEquidistant.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Average an irregular timeseries to a regular timeseries — MakeEquidistant","text":"ts object equidistant timeseries","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MakeEquidistant.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Average an irregular timeseries to a regular timeseries — MakeEquidistant","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MeanSpectrum.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted mean spectrum — MeanSpectrum","title":"Weighted mean spectrum — MeanSpectrum","text":"Calculate mean spectrum list individual spectra including weighting individual spectra , needed, interpolation highest resolution frequency grid. default weighting produces simple arithmetic mean. Interpolation performed frequency axes individual spectra different lengths /differ frequency discretization.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MeanSpectrum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted mean spectrum — MeanSpectrum","text":"","code":"MeanSpectrum(specList, iRemoveLowest = 1, weights = rep(1, length(specList)))"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MeanSpectrum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted mean spectrum — MeanSpectrum","text":"specList list spectra, .e. objects class \"spec\" (see SpecMTM details), spectrum list vectors freq, spec dof common length. iRemoveLowest integer; number lowest frequencies remove individual spectral estimate (e.g. remove detrending bias) prior interpolation averaging. weights numeric vector weights; length must match number elements specList. default setting identical weights yields simple arithmetic average input spectra; change parameter accordingly apply non-arithmetic averaging (see example).","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MeanSpectrum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted mean spectrum — MeanSpectrum","text":"object class \"spec\" weighted mean spectrum,   amended element nRecord gives number records   contributing mean spectral estimate.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MeanSpectrum.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Weighted mean spectrum — MeanSpectrum","text":"Thomas Laepple Thomas Münch","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MeanSpectrum.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Weighted mean spectrum — MeanSpectrum","text":"","code":"# Simple arithmetic average f1 <- 1 : 5 f2 <- f1 s1 <- rep(1, length(f1)) s2 <- rep(3, length(f2)) dof1 <- rep(1, length(f1)) dof2 <- rep(1, length(f2))  spectra <- list(list(freq = f1, spec = s1, dof = dof1),                 list(freq = f2, spec = s2, dof = dof2))  MeanSpectrum(spectra, iRemoveLowest = 0) #> $freq #> [1] 1 2 3 4 5 #>  #> $spec #> [1] 2 2 2 2 2 #>  #> $dof #> [1] 2 2 2 2 2 #>  #> $nRecord #> [1] 2 2 2 2 2 #>  #> $lim.1 #> [1] 78.99578 78.99578 78.99578 78.99578 78.99578 #>  #> $lim.2 #> [1] 0.5421701 0.5421701 0.5421701 0.5421701 0.5421701 #>  #> $pval #> [1] 0.05 #>  #> attr(,\"class\") #> [1] \"spec\"  # Weighted mean with interpolation f1 <- 1 : 5 f2 <- 3 : 8 s1 <- rep(1, length(f1)) s2 <- rep(3, length(f2)) dof1 <- rep(1, length(f1)) dof2 <- rep(1, length(f2))  spectra <- list(list(freq = f1, spec = s1, dof = dof1),                 list(freq = f2, spec = s2, dof = dof2))  MeanSpectrum(spectra, iRemoveLowest = 0, weights = c(1, 2)) #> $freq #> [1] 1 2 3 4 5 6 7 8 #>  #> $spec #> [1] 1.000000 1.000000 2.333333 2.333333 2.333333 3.000000 3.000000 3.000000 #>  #> $dof #> [1] 1 1 2 2 2 1 1 1 #>  #> $nRecord #> [1] 1 1 2 2 2 1 1 1 #>  #> $lim.1 #> [1] 1018.25827 1018.25827   92.16174   92.16174   92.16174 3054.77481 3054.77481 #> [8] 3054.77481 #>  #> $lim.2 #> [1] 0.1990491 0.1990491 0.6325317 0.6325317 0.6325317 0.5971473 0.5971473 #> [8] 0.5971473 #>  #> $pval #> [1] 0.05 #>  #> attr(,\"class\") #> [1] \"spec\" # with some detrending bias removal MeanSpectrum(spectra, iRemoveLowest = 1, weights = c(1, 2)) #> $freq #> [1] 2 3 4 5 6 7 8 #>  #> $spec #> [1] 1.000000 1.000000 2.333333 2.333333 3.000000 3.000000 3.000000 #>  #> $dof #> [1] 1 1 2 2 1 1 1 #>  #> $nRecord #> [1] 1 1 2 2 1 1 1 #>  #> $lim.1 #> [1] 1018.25827 1018.25827   92.16174   92.16174 3054.77481 3054.77481 3054.77481 #>  #> $lim.2 #> [1] 0.1990491 0.1990491 0.6325317 0.6325317 0.5971473 0.5971473 0.5971473 #>  #> $pval #> [1] 0.05 #>  #> attr(,\"class\") #> [1] \"spec\""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MonthlyFromDaily.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin daily values to monthly values — MonthlyFromDaily","title":"Bin daily values to monthly values — MonthlyFromDaily","text":"Assumes months equal length 365 day long year","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MonthlyFromDaily.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin daily values to monthly values — MonthlyFromDaily","text":"","code":"MonthlyFromDaily(ts.daily)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MonthlyFromDaily.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin daily values to monthly values — MonthlyFromDaily","text":"ts.daily vector 365 values","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MonthlyFromDaily.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin daily values to monthly values — MonthlyFromDaily","text":"vector 12 values","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/MonthlyFromDaily.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bin daily values to monthly values — MonthlyFromDaily","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/NaFillTs.html","id":null,"dir":"Reference","previous_headings":"","what":"NaFill — NaFillTs","title":"NaFill — NaFillTs","text":"NaFill","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/NaFillTs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"NaFill — NaFillTs","text":"","code":"NaFillTs(x)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/NaFillTs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"NaFill — NaFillTs","text":"x","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/NaFillTs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"NaFill — NaFillTs","text":"filled x","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/NaFillTs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"NaFill — NaFillTs","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PS.VarUntilF.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance of a powerlaw process if integrated from until frequency f — PS.VarUntilF","title":"Variance of a powerlaw process if integrated from until frequency f — PS.VarUntilF","text":"Integral PSD=f^(-beta) f1=1/N f2=f equals variance lowpass filtered powerlaw process WARNING: result normalized","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PS.VarUntilF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance of a powerlaw process if integrated from until frequency f — PS.VarUntilF","text":"","code":"PS.VarUntilF(f, beta, N)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PS.VarUntilF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance of a powerlaw process if integrated from until frequency f — PS.VarUntilF","text":"f frequency integrate beta powerlaw slope N length timeseries","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PS.VarUntilF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variance of a powerlaw process if integrated from until frequency f — PS.VarUntilF","text":"non-normalized variance","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PS.VarUntilF.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Variance of a powerlaw process if integrated from until frequency f — PS.VarUntilF","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PS.VarUntilF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variance of a powerlaw process if integrated from until frequency f — PS.VarUntilF","text":"","code":"beta <- 1 signal <- ts(SimPowerlaw(beta,100000)) spec <- SpecMTM(signal) v1 <- GetVarFromSpectra(spec,f=c(1/length(signal),0.5)) v2 <- GetVarFromSpectra(spec,f=c(1/length(signal),0.01)) PS.VarUntilF(0.01,beta,length(signal))/PS.VarUntilF(0.5,beta,length(signal)) #> [1] 0.6384378 v2$var/v1$var #> [1] 0.6111545"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorAfterRollmean.html","id":null,"dir":"Reference","previous_headings":"","what":"Numerical correlation of random timeseries with different filtering (running mean) — PSP.CorAfterRollmean","title":"Numerical correlation of random timeseries with different filtering (running mean) — PSP.CorAfterRollmean","text":"Numerical correlation random timeseries different filtering (running mean)","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorAfterRollmean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Numerical correlation of random timeseries with different filtering (running mean) — PSP.CorAfterRollmean","text":"","code":"PSP.CorAfterRollmean(N, betaSignal, betaNoise, R)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorAfterRollmean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Numerical correlation of random timeseries with different filtering (running mean) — PSP.CorAfterRollmean","text":"N Number points timeseries betaSignal powerlaw slope signal betaNoise powerlaw slope noise R expected correlation whole timeseries","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorAfterRollmean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Numerical correlation of random timeseries with different filtering (running mean) — PSP.CorAfterRollmean","text":"correlation unfiltered, 10point mean 50 point mean","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorAfterRollmean.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Numerical correlation of random timeseries with different filtering (running mean) — PSP.CorAfterRollmean","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorAfterRollmean.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Numerical correlation of random timeseries with different filtering (running mean) — PSP.CorAfterRollmean","text":"","code":"temp <- replicate(1000,PSP.CorAfterRollmean(1000,1,0,0.5)) rowMeans(temp) #> [1] 0.4991726 0.8205169 0.9298821 PSP.CorUntilF(c(0.5,0.5/10,0.5/50),1,0,1000,0.5) #> [1] 0.5000000 0.8253528 0.9341159"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorUntilF.html","id":null,"dir":"Reference","previous_headings":"","what":"lowpass filtered expected correlation of powerlaw signal pair — PSP.CorUntilF","title":"lowpass filtered expected correlation of powerlaw signal pair — PSP.CorUntilF","text":"Correlation two timeseries powerlaw signal powerlaw noise evaluated f equals correlation linearly coupled lowpass filtered powerlaw process","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorUntilF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"lowpass filtered expected correlation of powerlaw signal pair — PSP.CorUntilF","text":"","code":"PSP.CorUntilF(f, betaSignal, betaNoise, N, r)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorUntilF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"lowpass filtered expected correlation of powerlaw signal pair — PSP.CorUntilF","text":"f frequency integrate betaSignal powerlaw slope signal betaNoise powerlaw slope noise N Number points per timeseries r expected correlation unfiltered","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorUntilF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"lowpass filtered expected correlation of powerlaw signal pair — PSP.CorUntilF","text":"expected correlation timeseries","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorUntilF.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"lowpass filtered expected correlation of powerlaw signal pair — PSP.CorUntilF","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/PSP.CorUntilF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"lowpass filtered expected correlation of powerlaw signal pair — PSP.CorUntilF","text":"","code":"temp <- replicate(1000,PSP.CorAfterRollmean(1000,1,0,0.5)) rowMeans(temp) #> [1] 0.4999823 0.8218138 0.9307426 PSP.CorUntilF(f=c(0.5,0.5/10,0.5/50),betaSignal=1,betaNoise=0,N=1000,r=0.5) #> [1] 0.5000000 0.8253528 0.9341159"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimFromEmpiricalSpec.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a random timeseries consistent with an arbitrary numerical power spectrum — SimFromEmpiricalSpec","title":"Simulate a random timeseries consistent with an arbitrary numerical power spectrum — SimFromEmpiricalSpec","text":"Adapted SimPowerlaw","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimFromEmpiricalSpec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a random timeseries consistent with an arbitrary numerical power spectrum — SimFromEmpiricalSpec","text":"","code":"SimFromEmpiricalSpec(spec, N)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimFromEmpiricalSpec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a random timeseries consistent with an arbitrary numerical power spectrum — SimFromEmpiricalSpec","text":"spec Numerical power spectrum consisting list components $freq $spec N length timeseries generated","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimFromEmpiricalSpec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a random timeseries consistent with an arbitrary numerical power spectrum — SimFromEmpiricalSpec","text":"vector containing timeseries","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimFromEmpiricalSpec.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate a random timeseries consistent with an arbitrary numerical power spectrum — SimFromEmpiricalSpec","text":"Thomas Laepple Andrew Dolman","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimFromEmpiricalSpec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a random timeseries consistent with an arbitrary numerical power spectrum — SimFromEmpiricalSpec","text":"","code":"# Create a piecewise spectrum  ## helper function to generate continuous piecewise spectrum  PiecewiseLinear <- function(x, val.at.min.x, breaks, slopes){  breaks <- c(-Inf, breaks, Inf) slp.vec <- slopes[findInterval(x, breaks)] d.x <- diff(x) d.y <- c(d.x * tail(slp.vec, -1))  y <- cumsum(c(val.at.min.x, d.y))  data.frame(x, y)  } slps <- c(-1, -0.5, -1) brks <- c(1e-03, 1e-02) emp.spec <- PiecewiseLinear(log(seq(1/1e05, 1/2, 1/1e05)), 0, log(brks), slps) emp.spec <- exp(emp.spec) names(emp.spec) <- c(\"freq\", \"spec\")  plot(emp.spec, type = \"l\", log = \"xy\")   # Sample consistent with spectrum ts1 <- ts(SimFromEmpiricalSpec(emp.spec, 50000))  # re-estimate power spectrum spec1 <- SpecMTM(ts1) LPlot(spec1) lines(emp.spec, col = \"Red\") abline(v = brks, col = \"Green\")"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPLS.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a random timeseries with a powerlaw spectrum — SimPLS","title":"Simulate a random timeseries with a powerlaw spectrum — SimPLS","text":"function creates power-law series. problem   effectively produces (fractional) Brownian bridges, ,   end close beginning (cyclic signal), rather true fBm fGn   series. alpha>0, EXPECTED PSD equal alpha*f^(-beta). alpha<0, timeseries normalized EXPECTED   variance abs(alpha), EXPECTED PSD proportional f^(-beta).","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPLS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a random timeseries with a powerlaw spectrum — SimPLS","text":"","code":"SimPLS(N, beta, alpha = -1)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPLS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a random timeseries with a powerlaw spectrum — SimPLS","text":"N length timeseries generated beta Slope powerlaw. beta = 1 produces timeseries -1 slope plotted log-log power ~ frequency axes alpha constant. alpha > 0 parameter alpha * f^(-beta). alpha < 0, variance returned timeseries scaled expected value abs(alpha)","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPLS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a random timeseries with a powerlaw spectrum — SimPLS","text":"vector containing timeseries","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPLS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate a random timeseries with a powerlaw spectrum — SimPLS","text":"Torben Kunz, Andrew Dolman","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPLS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a random timeseries with a powerlaw spectrum — SimPLS","text":"","code":"# With a beta = 1 and alpha = 0.1 set.seed(202010312) ts1 <- ts(SimPLS(N = 1000, beta = 1, alpha = 0.1)) plot(ts1)  sp1 <- SpecMTM(ts1) LPlot(sp1) abline(log10(0.1), -1, col = \"Red\")   # beta = 0.5, alpha = 0.4 ts2 <- ts(SimPLS(1000, beta = 0.5, alpha = 0.4)) plot(ts2)  sp2 <- SpecMTM(ts2) LPlot(sp2) abline(log10(0.4), -0.5, col = \"Red\")   # beta = 1, alpha = -2 ts3 <- ts(SimPLS(1000, 1, alpha = -2)) plot(ts3)  var(ts3) #> [1] 2.869695  # the EXPECTED variance is -2, for a given random timeseries the actual value will differ rep.var <- replicate(100, {  var(SimPLS(1000, 1, -2)) })  hist(rep.var) abline(v  = 2, col = \"Red\")  mean(rep.var) #> [1] 2.01647"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlaw.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a random timeseries with a powerlaw spectrum — SimPowerlaw","title":"Simulate a random timeseries with a powerlaw spectrum — SimPowerlaw","text":"Simulate random timeseries powerlaw spectrum","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlaw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a random timeseries with a powerlaw spectrum — SimPowerlaw","text":"","code":"SimPowerlaw(beta, N)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlaw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a random timeseries with a powerlaw spectrum — SimPowerlaw","text":"beta slope N length timeseries generated","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlaw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a random timeseries with a powerlaw spectrum — SimPowerlaw","text":"vector containing timeseries","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlaw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate a random timeseries with a powerlaw spectrum — SimPowerlaw","text":"Method: FFT white noise, rescale, FFT back, result scaled variance 1","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlaw.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate a random timeseries with a powerlaw spectrum — SimPowerlaw","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlawPiecewise.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a timeseries with length N which has a spectra consisting of two powerlaws — SimPowerlawPiecewise","title":"Simulate a timeseries with length N which has a spectra consisting of two powerlaws — SimPowerlawPiecewise","text":"Simulate timeseries length N spectra consisting two powerlaws","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlawPiecewise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a timeseries with length N which has a spectra consisting of two powerlaws — SimPowerlawPiecewise","text":"","code":"SimPowerlawPiecewise(beta1, beta2, N, deltat = 1, breakpoint = 1/50)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlawPiecewise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a timeseries with length N which has a spectra consisting of two powerlaws — SimPowerlawPiecewise","text":"beta1 slope frequencies lower breakpoint beta2 slope frequencies higher breakpoint N Number points simulate deltat timestep timeseries breakpoint frequency breakpoint","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlawPiecewise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a timeseries with length N which has a spectra consisting of two powerlaws — SimPowerlawPiecewise","text":"N random numbers drawn according piecewise powerlaw PSD","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimPowerlawPiecewise.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate a timeseries with length N which has a spectra consisting of two powerlaws — SimPowerlawPiecewise","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimProxySeries.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the Climate — SimProxySeries","title":"Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the Climate — SimProxySeries","text":"function creates time series designed   can interpreted typical paleo proxy record. corresponds   one may expect underlying signal, exhibiting power-law   frequency scaling finite range frequencies (f_low   f_high), subject archive laboratory smoothing subsampled   potentially unequally spaced sampling times, single noisy   measurement made finite number signal carriers retrieved   physical sample.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimProxySeries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the Climate — SimProxySeries","text":"","code":"SimProxySeries(   a = -1,   b = 1,   nt = 100,   f.scl = 1,   smth.arch = list(type = \"n\", tau = 0),   smth.lab = list(type = \"n\", tau = 0),   N = 0,   t.smpl = NULL,   var.noise = 0,   val = 0,   rseeds = c(NA, NA, NA),   nser = 1 )  sim.proxy.series(   a = -1,   b = 1,   nt = 100,   f.scl = 1,   smth.arch = list(type = \"n\", tau = 0),   smth.lab = list(type = \"n\", tau = 0),   N = 0,   t.smpl = NULL,   var.noise = 0,   val = 0,   rseeds = c(NA, NA, NA),   nser = 1 )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimProxySeries.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the Climate — SimProxySeries","text":">= 0: proportionality constant underlying expected power   spectral density P = * f^-b. < 0: expected mean square (variance) final time series (  value function). Thus, underlying power spectral density   given P ~ f^-b. b Scaling exponent underlying power spectral density P = * f^-b. nt Determines lower cut-frequency: f_low = f.scl / nt. t.smpl == NULL: number sampling times (length final time   series). f.scl t.smpl != NULL: Scales cut-frequencies (lower   upper): f_low = f.scl / nt, f_high = f.scl * 0.5. t.smpl == NULL: f.scl effect. smth.arch Sets type time scale archive smoothing. Possible   values type \"n\": archive smoothing; \"bioturbation\": 'Berger   Heath' impulse response function, Lorentzian-shaped squared spectral   transfer function 1 / (1 + (2*pi*f*tau)^2); \"diffusion\": Gaussian-shaped   squared spectral transfer function exp(-(2*pi*f*tau)^2). Possible values tau positive real numbers. Setting tau == 0   equivalent setting type=\"n\". smth.lab Sets type time scale laboratory smoothing. Possible   values type \"n\": archive smoothing \"rect\": rectangular window   time domain (archive slice) -> Squared-sinc-shaped squared spectral   transfer function sinc^2(pi*f*tau) Possible values tau positive real numbers. Setting tau == 0   equivalent setting type=\"n\". N N > 0: Finite number signal carriers used single measurement, implying additional sample white noise scaled 1/N. N == 0: Infinite number signal carriers, implying additional sample white noise. t.smpl desired (arbitrary) sampling times (may contain duplicated entries need ordered time). t.smpl == NULL: sampling times 0:(nt-1), using FFT algorithm fast computation. t.smpl != NULL: specifies desired arbitrary (potentially unequally spaced) sampling times. set 0:(nt-1), result identical obtained t.smpl == NULL, computation (potentially much) slower FFT algorithm used. var.noise Variance additional sample white noise (may represent, example, measurement noise). val val == 0: value function time series. val > 0: value function list holds information   regarding true PSD. components $fax: frequency axis $psd: power spectral density $var:   variance total sample white noise (component exists   sample white noise included component $psd, see ) Possible positive values val 1: $psd holds full PSD, including sample white noise; vectors $psd   $fax limited elements $fax > 0 2: $psd holds PSD excluding sample white noise, variance   provided component $var; vectors $psd $fax limited   elements $fax > 0 3: '1', vectors $psd $fax extend frequencies   (including zero negative ones) 4: '2', vectors $psd $fax extend frequencies   (including zero negative ones) Note: t.smpl != NULL val == 1 val == 3, function   internally sets val <- val + 1, t.smpl might specify unequally   spaced sampling times PSD sample white noise might   defined. rseeds vector length 3, integer NA. Random seeds fix realisation specific random processes. three random processes: process-1 (controlled rseeds[1]) represents climate   process-2 (controlled rseeds[2]) represents signal carrier mixing   paths   process-3 (controlled rseeds[3]) represents additional sample white   noise (e.g., measurement noise) rseeds[] == NA: random sequence drawn rnorm() without setting   specific random seed . rseeds[] == integer: random seed set set.seed(rseeds[])   random sequence drawn rnorm. draw random   number generator reset previous state order avoid   interference calls random number generator inside   outside sim.proxy.series. nser integer (>=1) val == 0: number time series generated (parameters). val > 0: nser effect.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimProxySeries.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the Climate — SimProxySeries","text":"vector list.","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimProxySeries.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the Climate — SimProxySeries","text":"Torben Kunz","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimProxySeries.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a Proxy Time Series Assuming a Power-Law Power Spectrum of the Climate — SimProxySeries","text":"","code":"## Generate a power-law timeseries with no proxy archiving or measurement effects  n = 1e04  set.seed(1) ts1 <- SimProxySeries(a = 0.1, b = 1, nt = n) ts1 <- ts(ts1, deltat = 1) plot(ts1)   sp1 <- SpecMTM(ts1) LPlot(sp1, col = \"grey\") abline(log10(0.1), -1, col = \"black\")   ## Generate the same climate timeseries (by setting seed the same) but with smoothing ## from bioturbation  tau_b <- 50  set.seed(1) ts2 <- SimProxySeries(a = 0.1, b = 1, nt = n,  smth.arch = list(type = \"bioturbation\", tau = tau_b)) ts2 <- ts(ts2, deltat = 1) plot(ts1) lines(ts2, col = \"blue\")   sp2 <- SpecMTM(ts2) LPlot(sp1, ylim = range(c(sp1$spec, sp2$spec)), col = \"grey\") abline(log10(0.1), -1, col = \"black\") LLines(sp2, col = \"blue\")  ## Then add measurement error  set.seed(1) ts3 <- SimProxySeries(a = 0.1, b = 1, nt = n, smth.arch = list(type = \"bioturbation\", tau = tau_b),  var.noise = 0.1^2) ts3 <- ts(ts3, deltat = 1)  sp3 <- SpecMTM(ts3) LLines(sp3, col = \"pink\") abline(h = 1/2*(0.1^2 / diff(range(sp3$freq))), col = \"red\")   ## sample time series at arbitrary times  #' set.seed(1) time <- runif(100, 0, n) ts4 <- SimProxySeries(a = 0.1, b = 1, nt = n, t.smpl = time, smth.arch = list(type = \"bioturbation\", tau = tau_b),  var.noise = 0.1^2)  dat <- data.frame(time = time, ts4 = ts4) dat <- dat[order(time), ] plot(ts4~time, data = dat, type = \"b\")   # Note: even though seed was set, these points will not be from the same # timeseries as ts3.   ## Alternatively, generate the whole timeseries and subset at the desired ## timepoints if integer timepoints are acceptable. This can often be faster ## as it allows the fast FFT algorithm to be used.  time <- round(sort(time)) ts3_sub <- ts3[time]  plot(ts1, col = \"grey\") lines(ts2, col = \"blue\") lines(time, ts3_sub, col = \"Orange\", pch = 16) points(time, ts3_sub, col = \"Orange\", pch = 16)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimulatePowerlawSignalPair.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a pair of random signals with powerlaw signal and powerlaw noise — SimulatePowerlawSignalPair","title":"Create a pair of random signals with powerlaw signal and powerlaw noise — SimulatePowerlawSignalPair","text":"timeseries expected variance 1 expected correlation r","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimulatePowerlawSignalPair.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a pair of random signals with powerlaw signal and powerlaw noise — SimulatePowerlawSignalPair","text":"","code":"SimulatePowerlawSignalPair(n, beta.signal, beta.noise, r)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimulatePowerlawSignalPair.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a pair of random signals with powerlaw signal and powerlaw noise — SimulatePowerlawSignalPair","text":"r expected correlation vectors N Number points per timeseries betaSignal powerlaw slope signal betaNoise powerlaw slope noise","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimulatePowerlawSignalPair.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a pair of random signals with powerlaw signal and powerlaw noise — SimulatePowerlawSignalPair","text":"list containing vectors y1 y2","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimulatePowerlawSignalPair.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create a pair of random signals with powerlaw signal and powerlaw noise — SimulatePowerlawSignalPair","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SimulatePowerlawSignalPair.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a pair of random signals with powerlaw signal and powerlaw noise — SimulatePowerlawSignalPair","text":"","code":"mean(replicate(1000,{test <- SimulatePowerlawSignalPair(200,1,1,0.5);cor(test$y1,test$y2)})) #> [1] 0.4925773"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SlopeFit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a power-law to the spectrum — SlopeFit","title":"Fit a power-law to the spectrum — SlopeFit","text":"Fit power-law spectrum","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SlopeFit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a power-law to the spectrum — SlopeFit","text":"","code":"SlopeFit(   spec,   freq.start = NULL,   freq.end = NULL,   bDebug = TRUE,   breaks = NULL,   indexRemove = NULL,   df.log = 0.05,   i.fStart = 4 )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SlopeFit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a power-law to the spectrum — SlopeFit","text":"spec power spectrum list $freq $spec freq.start vector containing start frequencies fitting interval(s) freq.end vector containing end frequencies fitting interval(s) bDebug (TRUE) plot diagnostics breaks vector breakpoints spectra binned (optional) indexRemove bins removed (e.g. containing annual semiannual cycle) df.log resolution bins (breaks provided) .fStart index first (lowest) frequency used","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SlopeFit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a power-law to the spectrum — SlopeFit","text":"list(slope=slope,slopesd=slopesd,spec=saveSpec,freq=binFreq,intercept=intercept)","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SlopeFit.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fit a power-law to the spectrum — SlopeFit","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Spec2DF.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform Spec Object(s) Into a Dataframe — Spec2DF","title":"Transform Spec Object(s) Into a Dataframe — Spec2DF","text":"Transform Spec Object(s) Dataframe","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Spec2DF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform Spec Object(s) Into a Dataframe — Spec2DF","text":"","code":"Spec2DF(x)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Spec2DF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform Spec Object(s) Into a Dataframe — Spec2DF","text":"x spec object (optionally named) list spec objects.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Spec2DF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform Spec Object(s) Into a Dataframe — Spec2DF","text":"spec_df object","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Spec2DF.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Transform Spec Object(s) Into a Dataframe — Spec2DF","text":"Andrew Dolman <andrew.dolman@awi.de>","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/Spec2DF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform Spec Object(s) Into a Dataframe — Spec2DF","text":"","code":"library(PaleoSpec) ts1 <- ts(SimPLS(1000, beta = 1)) sp1 <- SpecMTM(ts1) sp1 <- AddConfInterval(sp1) ts2 <- ts(rnorm(1000)) sp2 <- SpecMTM(ts2) sp_lst <- list(sp1 = sp1, sp2 = sp2) sp_df <- Spec2DF(sp_lst) sp_df #> # A tibble: 1,000 × 6 #>    spec_id  freq  spec   dof  lim.1  lim.2 #>    <chr>   <dbl> <dbl> <dbl>  <dbl>  <dbl> #>  1 sp1     0.001 16.9   5.98  82.4   7.02  #>  2 sp1     0.002 32.7   5.96 160.   13.5   #>  3 sp1     0.003 21.6   5.99 105.    8.97  #>  4 sp1     0.004 31.8   5.99 154.   13.2   #>  5 sp1     0.005 28.9   5.98 141.   12.0   #>  6 sp1     0.006 11.6   5.98  56.5   4.82  #>  7 sp1     0.007  6.81  5.95  33.3   2.82  #>  8 sp1     0.008  6.76  5.95  33.1   2.80  #>  9 sp1     0.009  1.79  5.90   8.81  0.737 #> 10 sp1     0.01   2.97  5.96  14.5   1.23  #> # ℹ 990 more rows"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecACF.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Power Spectra via the Autocovariance Function With Optional Slepian Tapers — SpecACF","title":"Estimate Power Spectra via the Autocovariance Function With Optional Slepian Tapers — SpecACF","text":"Estimates power spectrum single time series,   mean spectrum set timeseries stored columns matrix.   Timeseries can contain () gaps coded NA values. Gaps results   additional estimation error power estimates longer   chi-square distributed can contain additional additive error,   extent power frequencies can negative.   full understanding estimation uncertainty, simulation testing   indicates estimates unbiased smoothing across   frequencies remove negative estimates results unbiased power   spectrum.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecACF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Power Spectra via the Autocovariance Function With Optional Slepian Tapers — SpecACF","text":"","code":"SpecACF(   x,   deltat = NULL,   bin.width = NULL,   k = 3,   nw = 2,   demean = TRUE,   detrend = TRUE,   TrimNA = TRUE,   pos.f.only = TRUE,   return.working = FALSE )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecACF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Power Spectra via the Autocovariance Function With Optional Slepian Tapers — SpecACF","text":"x vector matrix binned values, possibly gaps deltat, bin.width time-step timeseries, equivalently width bins binned timeseries, set one k positive integer, number tapers, often 2*nw. nw positive double precision number, time-bandwidth parameter. demean remove mean record (column) x, defaults TRUE. detrend TRUE, mean removed detrending regardless value demean detrend remove mean linear trend record (column) x, defaults FALSE pos.f.return positive frequencies, defaults TRUE TRUE, freq == 0, frequencies higher 1/(2*bin.width) correspond negative frequencies removed","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecACF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Power Spectra via the Autocovariance Function With Optional Slepian Tapers — SpecACF","text":"spec object (list)","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecACF.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimate Power Spectra via the Autocovariance Function With Optional Slepian Tapers — SpecACF","text":"Torben Kunz Andrew Dolman <andrew.dolman@awi.de>","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecACF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Power Spectra via the Autocovariance Function With Optional Slepian Tapers — SpecACF","text":"","code":"set.seed(20230312)  # Comparison with SpecMTM  tsM <- replicate(2, SimPLS(1e03, 1, 0.1)) spMk3 <- SpecACF(tsM, bin.width = 1, k = 3, nw = 2) spMk1 <- SpecACF(tsM, bin.width = 1, k = 1, nw = 0)  spMTMa <- SpecMTM(tsM[,1], deltat = 1) spMTMb <- SpecMTM(tsM[,2], deltat = 1) spMTM <- spMTMa spMTM$spec <- (spMTMa$spec + spMTMb$spec)/2  gg_spec(list(   `ACF k=1` = spMk1,   `ACF k=3` = spMk3,   `MTM k=3` = spMTM ), alpha.line = 0.75) +   ggplot2::facet_wrap(~spec_id)   ## No gaps  ts1 <- SimPLS(1000, 1, 0.1)  sp_ACF1 <- SpecACF(ts1, 1, k = 1) sp_MTM7 <- SpecMTM(ts1, nw = 4, k = 7, deltat = 1) sp_ACF7 <- SpecACF(ts1, 1, k = 7, nw = 4)  gg_spec(list(   `ACF k=1` = sp_ACF1, `ACF k=7` = sp_ACF7, `MTM k=7` = sp_MTM7 ))   # With Gaps  gaps <- (arima.sim(list(ar = 0.5), n = length(ts1))) > 1 table(gaps) #> gaps #> FALSE  TRUE  #>   808   192  ts1_g <- ts1 ts1_g[gaps] <- NA  sp_ACF1_g <- SpecACF(ts1_g, 1) sp_ACFMTM1_g <- SpecACF(ts1_g, bin.width = 1, nw = 4, k = 7)  gg_spec(list(   ACF_g = sp_ACF1_g,   ACF_g_smoothed = FilterSpecLog(sp_ACF1_g),   ACF_g_tapered = sp_ACFMTM1_g ), conf = FALSE) +   ggplot2::geom_abline(intercept = log10(0.1), slope = -1, lty = 2) #> Warning: NaNs produced #> Warning: log-10 transformation introduced infinite values. #> Warning: NaNs produced #> Warning: log-10 transformation introduced infinite values. #> Warning: Removed 2 rows containing missing values or values outside the scale range #> (`geom_line()`).     ## AR4 arc_spring <- c(2.7607, -3.8106, 2.6535, -0.9238)  tsAR4 <- arima.sim(list(ar = arc_spring), n = 1e03) + rnorm(1e03, 0, 10) plot(tsAR4)  spAR4_ACF <- SpecACF(tsAR4, 1) spAR4_MTACF <- SpecACF(as.numeric(tsAR4), 1, k = 15, nw = 8)  gg_spec(list(#'   `ACF k=1` = spAR4_ACF,   `ACF k=15` = spAR4_MTACF) )   ## Add gaps to timeseries  gaps <- (arima.sim(list(ar = 0.5), n = length(tsAR4))) > 2 table(gaps) #> gaps #> FALSE  TRUE  #>   969    31  tsAR4_g <- tsAR4 tsAR4_g[gaps] <- NA  plot(tsAR4, col = \"green\") lines(tsAR4_g, col = \"blue\")   table(tsAR4_g > 0, useNA = \"always\") #>  #> FALSE  TRUE  <NA>  #>   486   483    31   spAR4_ACF_g <- SpecACF(as.numeric(tsAR4_g), 1) spAR4_MTACF_g <- SpecACF(as.numeric(tsAR4_g), 1, nw = 8, k = 15)  table(spAR4_ACF_g$spec < 0) #>  #> FALSE  TRUE  #>   485    15  table(spAR4_MTACF_g$spec < 0) #>  #> FALSE  #>   500   gg_spec(list(   `ACF gaps k=1` = spAR4_ACF_g,   `ACF gaps k = 15` = spAR4_MTACF_g,   `ACF full k = 15` = spAR4_MTACF ) ) #> Warning: NaNs produced #> Warning: log-10 transformation introduced infinite values. #> Warning: NaNs produced #> Warning: log-10 transformation introduced infinite values."},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecInterpolate.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate spectrum — SpecInterpolate","title":"Interpolate spectrum — SpecInterpolate","text":"Interpolate spectrum given frequency resolution. interpolation includes spectral estimates well degrees freedom.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecInterpolate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate spectrum — SpecInterpolate","text":"","code":"SpecInterpolate(spec, freqRef, check = TRUE)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecInterpolate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate spectrum — SpecInterpolate","text":"spec spectral object class \"spec\" list minimum components freq, spec dof vectors length giving original frequency resolution corresponding spectral estimates degrees freedom. freqRef numeric vector target frequency resolution. check logical; TRUE (default) spec checked proper spectral object. can turned programmatic use respective check already performed.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecInterpolate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate spectrum — SpecInterpolate","text":"spectral object class \"spec\" spectrum   interpolated target resolution.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecInterpolate.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Interpolate spectrum — SpecInterpolate","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecInterpolate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interpolate spectrum — SpecInterpolate","text":"","code":"freqRef <- seq(0.1, 0.5, 0.1) spec <- list(freq = c(0.1, 0.2, 0.4, 0.5), spec = c(1, 2, 4, 5),              dof = rep(1, 4))  SpecInterpolate(spec, freqRef) #> $freq #> [1] 0.1 0.2 0.3 0.4 0.5 #>  #> $spec #> [1] 1 2 3 4 5 #>  #> $dof #> [1] 1 1 1 1 1 #>  #> attr(,\"class\") #> [1] \"spec\""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecMTM.html","id":null,"dir":"Reference","previous_headings":"","what":"MTM spectral estimator — SpecMTM","title":"MTM spectral estimator — SpecMTM","text":"calls spec.mtm library multitaper","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecMTM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MTM spectral estimator — SpecMTM","text":"","code":"SpecMTM(   timeSeries,   k = 3,   nw = 2,   nFFT = \"default\",   centre = c(\"Slepian\"),   dpssIN = NULL,   returnZeroFreq = FALSE,   Ftest = FALSE,   jackknife = FALSE,   jkCIProb = 0.95,   maxAdaptiveIterations = 100,   plot = FALSE,   na.action = na.fail,   returnInternals = FALSE,   detrend = TRUE,   bPad = FALSE,   ... )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecMTM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MTM spectral estimator — SpecMTM","text":"timeSeries time series equally spaced data, can created ts() function deltat specified. k positive integer, number tapers, often 2*nw. nw positive double precision number, time-bandwidth parameter. nFFT function pads data computing fft. nFFT indicates total length data padding. centre time series centred using one three methods: expansion     onto discrete prolate spheroidal sequences ('Slepian'), arithmetic mean ('arithMean'),     trimmed mean ('trimMean'), ('none'). dpssIN Allows user enter dpss object already     created. can save computation time Slepians  bandwidth parameter number tapers used repeatedly. returnZeroFreq Boolean variable indicating zeroth     frequency (DC component) returned applicable arrays. Ftest Boolean variable indicating Ftest result  computed returned. jackknife Boolean variable indicating jackknifed confidence intervals computed returned. jkCIProb Decimal value indicating jackknife probability calculating jackknife confidence intervals. default returns 95% confidence interval. maxAdaptiveIterations Maximum number iterations adaptive multitaper calculation. Generally convergence quick, require less 100 iterations. plot Boolean variable indicating spectrum plotted. na.action Action take NAs exist data, default     fail. returnInternals Return weighted eigencoefficients, complex mean values, . necessary extensions multitaper, including magnitude-squared coherence (function mtm.coh package). Note:   internal ($mtm) variables eigenCoefs eigenCoefWt correspond multitaper eigencoefficients. eigencoefficients correspond equation (3.4) weights, eigenCoefWt, correspond sqrt(|d_k(f)|^2) equation (5.4) Thomson's 1982 paper. square root values contained eigenCoefWt commonly used additional calculations (example: eigenCoefWt * eigenCoefs).  values returned mtm$cmv correspond estimate  coefficients hat(mu)(f) equation (13.5) Thomson (1982),  estimate hat(C)_1 frequency 1 equation (499) form Percival Walden (1993) detrend logical, detrend timeseries estimating spectrum bPad FALSE (default) nFFT set length timeseries ... additional arguments multitaper::spec.mtm","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecMTM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MTM spectral estimator — SpecMTM","text":"spectra object list(freq, spec, dof)","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecMTM.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"MTM spectral estimator — SpecMTM","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SpecMTM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MTM spectral estimator — SpecMTM","text":"","code":"x <- ts(arima.sim(list(ar = 0.9), 1000)) spec <- SpecMTM(x) LPlot(spec, col='grey') LLines(LogSmooth(spec), lwd=2)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SubsampleTimeseriesBlock.html","id":null,"dir":"Reference","previous_headings":"","what":"Subsample (downsample) timeseries using block averaging#' — SubsampleTimeseriesBlock","title":"Subsample (downsample) timeseries using block averaging#' — SubsampleTimeseriesBlock","text":"Resample equidistant timeseries (e.g. model result)   'timepoints' using block averaging. blocks divided 1/2 time   requested output points. first (last) timepoint,   interval starting mean(diff(timepoints)) (ending )   used. Example usage downsample model timeseries mimick   integrating proxy (e.g. water isotopes measured melting pieces   ice).","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SubsampleTimeseriesBlock.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subsample (downsample) timeseries using block averaging#' — SubsampleTimeseriesBlock","text":"","code":"SubsampleTimeseriesBlock(ts, timepoints)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SubsampleTimeseriesBlock.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subsample (downsample) timeseries using block averaging#' — SubsampleTimeseriesBlock","text":"ts ts object vector containing equidistant timeseries timepoints vector points time","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SubsampleTimeseriesBlock.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subsample (downsample) timeseries using block averaging#' — SubsampleTimeseriesBlock","text":"values timepoints","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SubsampleTimeseriesBlock.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Subsample (downsample) timeseries using block averaging#' — SubsampleTimeseriesBlock","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/SubsampleTimeseriesBlock.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subsample (downsample) timeseries using block averaging#' — SubsampleTimeseriesBlock","text":"","code":"input <- ts(SimPowerlaw(0.5, 1000)) timepoints <- seq(from = 50, to = 950, by = 50) result <- SubsampleTimeseriesBlock(input, timepoints) plot(input, main = \"Comparison of block avg. vs. simple interpolation\",   ylab = \"unitless\") points(timepoints, result, pch = 19, col = \"red\", lwd = 3) points(approx(time(input), c(input), timepoints), col = \"green\",   pch = 10, lwd = 3) legend(\"bottom\", col = c(\"black\", \"red\", \"green\"), lwd = 2, bty = \"n\",   c(\"High-resolution timeseries (input)\", \" Block Avg\", \"interpolated values\"))"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/TrimNA.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove leading and trailing rows of all NA — TrimNA","title":"Remove leading and trailing rows of all NA — TrimNA","text":"Remove leading trailing rows NA","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/TrimNA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove leading and trailing rows of all NA — TrimNA","text":"","code":"TrimNA(m, trim = c(\"all\", \"any\"))"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/TrimNA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove leading and trailing rows of all NA — TrimNA","text":"m numeric matrix, data.frame vector trim trim leading trailing rows \"\" NA containing \"\" NA values","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/TrimNA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove leading and trailing rows of all NA — TrimNA","text":"numeric matrix, data.frame vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/TrimNA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove leading and trailing rows of all NA — TrimNA","text":"","code":"m <- matrix(c(NA, NA, NA, 1, NA, NA, NA, 1, 1, NA, NA, NA, 1:9, NA,NA,NA, 10:12, NA, 1, NA, NA,NA,NA), ncol = 3, byrow = TRUE) m #>       [,1] [,2] [,3] #>  [1,]   NA   NA   NA #>  [2,]    1   NA   NA #>  [3,]   NA    1    1 #>  [4,]   NA   NA   NA #>  [5,]    1    2    3 #>  [6,]    4    5    6 #>  [7,]    7    8    9 #>  [8,]   NA   NA   NA #>  [9,]   10   11   12 #> [10,]   NA    1   NA #> [11,]   NA   NA   NA TrimNA(m) #>       [,1] [,2] [,3] #>  [1,]    1   NA   NA #>  [2,]   NA    1    1 #>  [3,]   NA   NA   NA #>  [4,]    1    2    3 #>  [5,]    4    5    6 #>  [6,]    7    8    9 #>  [7,]   NA   NA   NA #>  [8,]   10   11   12 #>  [9,]   NA    1   NA TrimNA(m, trim = \"any\") #>      [,1] [,2] [,3] #> [1,]    1    2    3 #> [2,]    4    5    6 #> [3,]    7    8    9 #> [4,]   NA   NA   NA #> [5,]   10   11   12"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.data.frame.spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform a spec Object Into a Dataframe — as.data.frame.spec","title":"Transform a spec Object Into a Dataframe — as.data.frame.spec","text":"Transform spec Object Dataframe","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.data.frame.spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform a spec Object Into a Dataframe — as.data.frame.spec","text":"","code":"# S3 method for class 'spec' as.data.frame(x)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.data.frame.spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform a spec Object Into a Dataframe — as.data.frame.spec","text":"x spec object","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.data.frame.spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform a spec Object Into a Dataframe — as.data.frame.spec","text":"dataframe tibble (package tibble installed)","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.data.frame.spec.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Transform a spec Object Into a Dataframe — as.data.frame.spec","text":"Andrew Dolman <andrew.dolman@awi.de>","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.data.frame.spec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform a spec Object Into a Dataframe — as.data.frame.spec","text":"","code":"library(PaleoSpec) ts1 <- ts(rnorm(100)) sp1 <- SpecMTM(ts1) sp1_df <- as.data.frame(sp1)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a spec Object — as.spec","title":"Make a spec Object — as.spec","text":"Make spec Object","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a spec Object — as.spec","text":"","code":"as.spec(x)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a spec Object — as.spec","text":"x named list (least) elements freq, spec, dof","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a spec Object — as.spec","text":"Object class spec","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as.spec.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Make a spec Object — as.spec","text":"Andrew Dolman <andrew.dolman@awi.de>","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as_spec_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a spec_df Object — as_spec_df","title":"Make a spec_df Object — as_spec_df","text":"Make spec_df Object","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as_spec_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a spec_df Object — as_spec_df","text":"","code":"as_spec_df(x)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as_spec_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a spec_df Object — as_spec_df","text":"x dataframe tibble (least) columns freq, spec, dof","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as_spec_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a spec_df Object — as_spec_df","text":"Object class spec_df","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/as_spec_df.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Make a spec_df Object — as_spec_df","text":"Andrew Dolman <andrew.dolman@awi.de>","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/fweights.html","id":null,"dir":"Reference","previous_headings":"","what":"weights — fweights","title":"weights — fweights","text":"weights","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/fweights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"weights — fweights","text":"","code":"fweights(ftarget, f, df.log)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/fweights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"weights — fweights","text":"weight vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/fweights.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"weights — fweights","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/fweights.lin.html","id":null,"dir":"Reference","previous_headings":"","what":"fweights.lin — fweights.lin","title":"fweights.lin — fweights.lin","text":"fweights.lin","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/fweights.lin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"fweights.lin — fweights.lin","text":"","code":"fweights.lin(ftarget, f, df.log)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/fweights.lin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"fweights.lin — fweights.lin","text":"weight vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/fweights.lin.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"fweights.lin — fweights.lin","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/gen.ran.seq.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Random Numbers Without Affecting the State of .Random.seed — gen.ran.seq","title":"Generate Random Numbers Without Affecting the State of .Random.seed — gen.ran.seq","text":"Generate Random Numbers Without Affecting State .Random.seed","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/gen.ran.seq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Random Numbers Without Affecting the State of .Random.seed — gen.ran.seq","text":"","code":"gen.ran.seq(n, nser, s)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/gen.ran.seq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Random Numbers Without Affecting the State of .Random.seed — gen.ran.seq","text":"n number observations nser number replicate series s NA integer, passed set.seed() integer","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/gen.ran.seq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Random Numbers Without Affecting the State of .Random.seed — gen.ran.seq","text":"matrix","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/gg_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot One or More Spectra with ggplot2 — gg_spec","title":"Plot One or More Spectra with ggplot2 — gg_spec","text":"Plot One Spectra ggplot2","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/gg_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot One or More Spectra with ggplot2 — gg_spec","text":"","code":"gg_spec(   x,   gg = NULL,   conf = TRUE,   spec_id = NULL,   colour = spec_id,   group = spec_id,   linetype = NULL,   alpha.line = 1,   alpha.ribbon = c(0.166, 0.333),   removeFirst = 0,   removeLast = 0,   min.colours = 2,   force.lims = FALSE,   force.CI = NULL,   quantiles = FALSE,   time_unit = NULL )"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/gg_spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot One or More Spectra with ggplot2 — gg_spec","text":"x object class \"spec\" \"spec_df\" gg existing ggplot object add new spec layer conf Plot shaded confidence interval exists spec object spec_id Name plot layer colour Name variable map colour, unquoted group Name variable map group, unquoted linetype Name variable map linetype, unquoted alpha.line Alpha level spectra line(s) alpha.ribbon Alpha level confidence region(s) removeFirst, removeLast Remove first last \"n\" values low high frequency side respectively. Operates per group basis. min.colours Minimum number spectra starting colour separately force.lims, force.CI Force plotting confidence regions total number frequencies exceeds 10000. force.CI deprecated, use force.lims. Defaults FALSE quantiles Plot uncertainty quantiles exist spec object time_unit Optional string giving time unit axes labels, e.g. \"years\"","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/gg_spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot One or More Spectra with ggplot2 — gg_spec","text":"ggplot object","code":""},{"path":[]},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/gg_spec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot One or More Spectra with ggplot2 — gg_spec","text":"","code":"library(PaleoSpec) N <- 1e03 beta <- 1 alpha <- 0.1  ts1 <- SimPLS(N = N, b = beta, a = alpha) ts2 <- SimPLS(N = N, b = beta, a = alpha) sp1 <- SpecMTM(ts1, deltat = 1) sp1 <- AddConfInterval(sp1) sp2 <- SpecMTM(ts2, deltat = 1)  # plot single spectrum p <- gg_spec(sp1, spec_id = \"df1\") #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. p   # Add additional second spectra p <- gg_spec(sp2, p, spec_id = \"df2\", removeFirst = 2) #> Scale for x is already present. #> Adding another scale for x, which will replace the existing scale. #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. #> Scale for alpha is already present. #> Adding another scale for alpha, which will replace the existing scale. p   p <- gg_spec(sp1, p, spec_id = \"df3\", removeLast = 200) #> Scale for x is already present. #> Adding another scale for x, which will replace the existing scale. #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. #> Scale for alpha is already present. #> Adding another scale for alpha, which will replace the existing scale. p   sp2 <- LogSmooth(sp1) p <- gg_spec(sp1, spec_id = \"df1\") #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. p <- gg_spec(sp2, p, spec_id = \"df2\") #> Scale for x is already present. #> Adding another scale for x, which will replace the existing scale. #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. #> Scale for alpha is already present. #> Adding another scale for alpha, which will replace the existing scale. p <- p + ggplot2::geom_abline(intercept = log10(alpha), slope = -beta, colour = \"red\") p   # Or directly plot named or unnamed list  gg_spec(list(sp1, sp2))  gg_spec(list(raw = sp1, smoothed = sp2))   # without setting any names all spectra will be black p <- gg_spec(sp1) #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. sp2 <- LogSmooth(sp1) p <- gg_spec(sp2, p) #> Scale for x is already present. #> Adding another scale for x, which will replace the existing scale. #> Scale for y is already present. #> Adding another scale for y, which will replace the existing scale. #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. #> Scale for alpha is already present. #> Adding another scale for alpha, which will replace the existing scale. #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale. p"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/is.spectrum.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for spectral object — is.spectrum","title":"Check for spectral object — is.spectrum","text":"PaleoSpec \"spectral object\" defined list consisting minimum requirement three elements freq, spec, dof, numeric vectors length giving frequency axis, power spectral density, degrees freedom spectral estimate. functions package require object main input. function checks object minimum requirements.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/is.spectrum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for spectral object — is.spectrum","text":"","code":"is.spectrum(x, check.only = FALSE, dof = TRUE)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/is.spectrum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for spectral object — is.spectrum","text":"x object checked. check.logical; default means issue error requirement met. set TRUE, requirements checked, function returns TRUE pass, FALSE one checks fail. dof logical; per default, x also checked containing dof vector, can turned unnecessary.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/is.spectrum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for spectral object — is.spectrum","text":"logical value check.= TRUE.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/is.spectrum.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Check for spectral object — is.spectrum","text":"Thomas Münch","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/mean.ACF.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — mean.ACF","title":"Title — mean.ACF","text":"Title","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/mean.ACF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — mean.ACF","text":"","code":"# S3 method for class 'ACF' mean(x, return.working = FALSE)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/mean.ACF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — mean.ACF","text":"x matrix return.working return intermediate steps, defaults FALSE","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/mean.ACF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — mean.ACF","text":"matrix","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/mvacf.by.fft.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — mvacf.by.fft","title":"Title — mvacf.by.fft","text":"Title","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/mvacf.by.fft.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — mvacf.by.fft","text":"","code":"mvacf.by.fft(x)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/mvacf.by.fft.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — mvacf.by.fft","text":"x matrix","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/mvacf.by.fft.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — mvacf.by.fft","text":"matrix","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.highestFreq.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove high frequencies — remove.highestFreq","title":"Remove high frequencies — remove.highestFreq","text":"Remove highest frequencies spectra, since may biased MTM estimator.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.highestFreq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove high frequencies — remove.highestFreq","text":"","code":"remove.highestFreq(spec, iRemove)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.highestFreq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove high frequencies — remove.highestFreq","text":"spec list object class \"spec\". iRemove integer; number highest frequencies remove.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.highestFreq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove high frequencies — remove.highestFreq","text":"input data data iRemove highest   frequencies removed.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.highestFreq.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Remove high frequencies — remove.highestFreq","text":"Thomas Münch","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.lowestFreq.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove low frequencies — remove.lowestFreq","title":"Remove low frequencies — remove.lowestFreq","text":"Remove lowest frequencies spectra, since biased detrending MTM estimator.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.lowestFreq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove low frequencies — remove.lowestFreq","text":"","code":"remove.lowestFreq(spec, iRemove)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.lowestFreq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove low frequencies — remove.lowestFreq","text":"spec list object class \"spec\". iRemove integer; number lowest frequencies remove.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.lowestFreq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove low frequencies — remove.lowestFreq","text":"input data data iRemove lowest   frequencies removed.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/remove.lowestFreq.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Remove low frequencies — remove.lowestFreq","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlin.cutEnd.html","id":null,"dir":"Reference","previous_headings":"","what":"smoothlin.cutEnd — smoothlin.cutEnd","title":"smoothlin.cutEnd — smoothlin.cutEnd","text":"smoothlin.cutEnd","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlin.cutEnd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"smoothlin.cutEnd — smoothlin.cutEnd","text":"","code":"smoothlin.cutEnd(x, f, df.log, dof = 1)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlin.cutEnd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"smoothlin.cutEnd — smoothlin.cutEnd","text":"smoothed x","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlin.cutEnd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"smoothlin.cutEnd — smoothlin.cutEnd","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlog.cutEnd.html","id":null,"dir":"Reference","previous_headings":"","what":"smoothlog.cutEnd — smoothlog.cutEnd","title":"smoothlog.cutEnd — smoothlog.cutEnd","text":"smoothlog.cutEnd","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlog.cutEnd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"smoothlog.cutEnd — smoothlog.cutEnd","text":"","code":"smoothlog.cutEnd(x, f, df.log, dof = 1)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlog.cutEnd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"smoothlog.cutEnd — smoothlog.cutEnd","text":"smoothed x","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlog.cutEnd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"smoothlog.cutEnd — smoothlog.cutEnd","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlog.html","id":null,"dir":"Reference","previous_headings":"","what":"smoothlog — smoothlog","title":"smoothlog — smoothlog","text":"smoothlog","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlog.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"smoothlog — smoothlog","text":"","code":"smoothlog(x, f, df.log)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlog.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"smoothlog — smoothlog","text":"smoothed x","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/smoothlog.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"smoothlog — smoothlog","text":"Thomas Laepple","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/weights.html","id":null,"dir":"Reference","previous_headings":"","what":"weights — weights","title":"weights — weights","text":"weights","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"weights — weights","text":"","code":"weights(x, sigma)"},{"path":"https://earthsystemdiagnostics.github.io/paleospec/reference/weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"weights — weights","text":"vector","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-033","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.33","title":"PaleoSpec 0.33","text":"AddConfInterval calculation changed calculated confidence intervals give interval within true spectrum lie frequency 1-p.  Previous versions returned interval , applied ‘true’ spectrum, contain new spectral estimates frequency 1-p. Improvements calculation DOF FilterSpec FilterSpecLog. DOF calculation now accounts non independence ordinates existing filter tapering.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-032","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.32","title":"PaleoSpec 0.32","text":"SpecACF can now use slepian tapers Small fix rfreq calculation SpecACF RemoveFirst RemoveLast gg_spec work per spectrum basis list spec_df objects","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-031","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.31","title":"PaleoSpec 0.31","text":"Improve linking function documentation using @family","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-03","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.3","title":"PaleoSpec 0.3","text":"Add FilterSpec FilterSpecLog replacements / alternatives LogSmooth FilterSpec FilterSpecLog uses ApplyFilter (optionally) avoid loosing highest lowest frequencies smoothing spectrum. Default behaviour method 3: min roughness (reflect invert ends). Avoids artefact seen high freqs LogSmooth.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-0291","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.91","title":"PaleoSpec 0.2.91","text":"Return vector dof SpecMTM even == 2 Allow forcing CI gg_spec even number freq large small doc changes","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-029","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.9","title":"PaleoSpec 0.2.9","text":"Add gg_spec","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-028","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.8","title":"PaleoSpec 0.2.8","text":"Add SpecACF related functions","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-027","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.7","title":"PaleoSpec 0.2.7","text":"Add “TidySpec” functions convert spec objects data.frames/tibbles Add new class “spec_df” data.frame spec object(s)","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-026","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.6","title":"PaleoSpec 0.2.6","text":"Return vector DOF LogSmooth even Add tests freq trimming LogSmooth Minor documentation fixes","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-025","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.5","title":"PaleoSpec 0.2.5","text":"New function SimProxySeries, sim.proxy.series","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-024","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.4","title":"PaleoSpec 0.2.4","text":"Bug fix Bandpass() calling lowpass instead Lowpass","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-023","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.3","title":"PaleoSpec 0.2.3","text":"Overhaul spectral averaging interpolation functions","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-022","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.2","title":"PaleoSpec 0.2.2","text":"Bug fix ApplyFilter() function following #3: bug occurred upon matching filtered values back index positions original input time series vector removing leading/trailing NA values, happened case duplicate values input series. fixed now update index matching.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-021","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.1","title":"PaleoSpec 0.2.1","text":"leading trailing NA values automatically stripped input migrate filtered result upon applying endpoint constraint methods, added applying filter, output result length input; internal NA values still ignored per default, can removed linear interpolation neighbouring values toggling respective new function parameter. Source code function tidied, function documentation updated, unit code testing added.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-020","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.2.0","title":"PaleoSpec 0.2.0","text":"New function SimPLS() simulate powerlaw timeseries prescribed alpha, .e. alpha*f^(-beta).","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-010","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.1.0","title":"PaleoSpec 0.1.0","text":"Proper package version.","code":""},{"path":"https://earthsystemdiagnostics.github.io/paleospec/news/index.html","id":"paleospec-0009000","dir":"Changelog","previous_headings":"","what":"PaleoSpec 0.0.0.9000","title":"PaleoSpec 0.0.0.9000","text":"Rough migration bundle functions based paleolibrary PaleoSpec package.","code":""}]
